{
  "__inputs": [
    {
      "name": "DS_LOKI",
      "label": "Loki",
      "description": "Loki datasource for Cloudflare Logpush data",
      "type": "datasource",
      "pluginId": "loki",
      "pluginName": "Loki"
    }
  ],
  "__elements": {},
  "__requires": [
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "11.0.0"
    },
    {
      "type": "datasource",
      "id": "loki",
      "name": "Loki",
      "version": "1.0.0"
    },
    {
      "type": "panel",
      "id": "barchart",
      "name": "Bar chart",
      "version": ""
    },
    {
      "type": "panel",
      "id": "geomap",
      "name": "Geomap",
      "version": ""
    },
    {
      "type": "panel",
      "id": "piechart",
      "name": "Pie chart",
      "version": ""
    },
    {
      "type": "panel",
      "id": "stat",
      "name": "Stat",
      "version": ""
    },
    {
      "type": "panel",
      "id": "table",
      "name": "Table",
      "version": ""
    },
    {
      "type": "panel",
      "id": "timeseries",
      "name": "Time series",
      "version": ""
    }
  ],
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "description": "Cloudflare Logpush analytics - HTTP requests, firewall events, Workers trace events, SOC/security, performance",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "panels": [],
      "title": "Overview",
      "type": "row"
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 1000
              },
              {
                "color": "red",
                "value": 10000
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 0,
        "y": 1
      },
      "id": 2,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "title": "Requests",
      "type": "stat",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__range]))",
          "legendFormat": "Requests",
          "refId": "A",
          "queryType": "instant",
          "instant": true
        }
      ],
      "description": "Total HTTP requests across all zones over the selected time range."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 1
              },
              {
                "color": "red",
                "value": 5
              }
            ]
          },
          "unit": "percent",
          "max": 100,
          "min": 0
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 6,
        "y": 1
      },
      "id": 3,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "title": "Error Rate % (5xx)",
      "type": "stat",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeResponseStatus, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | EdgeResponseStatus >= 500 [$__range])) / sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__range])) * 100",
          "legendFormat": "5xx %",
          "refId": "A",
          "queryType": "instant",
          "instant": true
        }
      ],
      "description": "Percentage of requests returning 5xx status codes (server errors) over the selected time range."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "yellow",
                "value": 50
              },
              {
                "color": "green",
                "value": 80
              }
            ]
          },
          "unit": "percent",
          "max": 100,
          "min": 0
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 12,
        "y": 1
      },
      "id": 4,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "title": "Cache Hit Ratio %",
      "type": "stat",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus = `hit` [$__range])) / sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus != `` [$__range])) * 100",
          "legendFormat": "Cache Hit %",
          "refId": "A",
          "queryType": "instant",
          "instant": true
        }
      ],
      "description": "Ratio of cache hits to all cacheable requests over the selected time range. Higher is better."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 10
              },
              {
                "color": "red",
                "value": 50
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 18,
        "y": 1
      },
      "id": 5,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "title": "Firewall Events",
      "type": "stat",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"firewall_events\"} | json ClientIP, ClientRequestHost | ClientRequestHost =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientIP =~ \"$ip\" [$__range]))",
          "legendFormat": "Events",
          "refId": "A",
          "queryType": "instant",
          "instant": true
        }
      ],
      "description": "Total firewall events (blocks, challenges, logs) across all zones over the selected time range."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 1
              },
              {
                "color": "red",
                "value": 10
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 0,
        "y": 5
      },
      "id": 6,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "title": "Leaked Credentials",
      "type": "stat",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, LeakedCredentialCheckResult, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | LeakedCredentialCheckResult != `` | LeakedCredentialCheckResult != `clean` [$__range]))",
          "legendFormat": "Leaked",
          "refId": "A",
          "queryType": "instant",
          "instant": true
        }
      ],
      "description": "Requests where Cloudflare detected leaked credentials (username/password) over the selected time range. Excludes 'clean' results."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 5
              },
              {
                "color": "red",
                "value": 20
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 6,
        "y": 5
      },
      "id": 7,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "title": "High Risk WAF (score<20)",
      "type": "stat",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, WAFAttackScore, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | WAFAttackScore > 0 | WAFAttackScore <= 20 [$__range]))",
          "legendFormat": "Attacks",
          "refId": "A",
          "queryType": "instant",
          "instant": true
        }
      ],
      "description": "Requests with WAF attack score 1-20 (high risk of being an attack: SQLi, XSS, or RCE) over the selected time range."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 20
              },
              {
                "color": "red",
                "value": 50
              }
            ]
          },
          "unit": "percent",
          "max": 100,
          "min": 0
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 12,
        "y": 5
      },
      "id": 8,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "title": "Bot Traffic % (score<30)",
      "type": "stat",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json BotScore, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | BotScore > 0 | BotScore < 30 [$__range])) / sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json BotScore, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | BotScore > 0 [$__range])) * 100",
          "legendFormat": "Bot %",
          "refId": "A",
          "queryType": "instant",
          "instant": true
        }
      ],
      "description": "Percentage of traffic classified as likely bot (BotScore 1-29) by Cloudflare Bot Management over the selected time range."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 1
              },
              {
                "color": "red",
                "value": 10
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 18,
        "y": 5
      },
      "id": 9,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "textMode": "auto"
      },
      "title": "Worker Errors",
      "type": "stat",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"workers_trace_events\"} | json Outcome | Outcome != `ok` [$__range]))",
          "legendFormat": "Errors",
          "refId": "A",
          "queryType": "instant",
          "instant": true
        }
      ],
      "description": "Workers execution failures (exceptions, CPU exceeded, memory exceeded) over the selected time range."
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 9
      },
      "id": 10,
      "panels": [],
      "title": "HTTP Requests",
      "type": "row"
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 10
      },
      "id": 11,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Requests by Host",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientRequestHost) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__auto]))",
          "legendFormat": "{{ClientRequestHost}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Request volume broken down by zone/hostname."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": "5.."
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byRegexp",
              "options": "4.."
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byRegexp",
              "options": "3.."
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byRegexp",
              "options": "2.."
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 10
      },
      "id": 12,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge Response Status Codes",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (EdgeResponseStatus) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeResponseStatus, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__auto]))",
          "legendFormat": "{{EdgeResponseStatus}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "HTTP response status codes returned by the Cloudflare edge to the client. Color-coded: 2xx=green, 3xx=blue, 4xx=orange, 5xx=red."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 0,
        "y": 18
      },
      "id": 13,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Requests by Method",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientRequestMethod) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestMethod, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__auto]))",
          "legendFormat": "{{ClientRequestMethod}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Distribution of HTTP methods (GET, POST, PUT, DELETE, etc.)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 6,
        "y": 18
      },
      "id": 14,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Requests by Protocol",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientRequestProtocol) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientRequestProtocol, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__auto]))",
          "legendFormat": "{{ClientRequestProtocol}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "HTTP protocol version distribution (HTTP/1.1, HTTP/2, HTTP/3)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 18
      },
      "id": 15,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Request Source (Eyeball vs Worker)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientRequestSource) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientRequestSource, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__auto]))",
          "legendFormat": "{{ClientRequestSource}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Whether the request came from an end user (eyeball) or a Cloudflare Worker subrequest."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 18,
        "y": 18
      },
      "id": 16,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top Paths",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(20, sum by (ClientRequestPath) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__range])))",
          "legendFormat": "{{ClientRequestPath}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Most requested URL paths. Uses approx_topk for probabilistic top-k over high-cardinality path data."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 26
      },
      "id": 17,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top User Agents (Bot score < 30)",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(20, sum by (ClientRequestUserAgent) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json BotScore, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientRequestUserAgent, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | BotScore > 0 | BotScore < 30 [$__range])))",
          "legendFormat": "{{ClientRequestUserAgent}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Most common User-Agent strings among requests classified as likely bots (BotScore 1-29)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 26
      },
      "id": 18,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Error Rate by Path (4xx+5xx)",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(20, sum by (ClientRequestPath) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeResponseStatus, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | EdgeResponseStatus >= 400 [$__range])))",
          "legendFormat": "{{ClientRequestPath}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "URL paths generating the most 4xx and 5xx errors. Useful for identifying broken endpoints or targeted attack paths."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "user:ban"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "user:chl"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "macro:ban"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "macro:chl"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "filter:ban"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "purple",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "macro:temp_ok"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 34
      },
      "id": 19,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge Pathing (request handling decisions)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (EdgePathingSrc, EdgePathingOp) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgePathingOp, EdgePathingSrc, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | EdgePathingOp != `wl` [$__auto]))",
          "legendFormat": "{{EdgePathingSrc}}:{{EdgePathingOp}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "How Cloudflare decided to handle each request. src=decision source (user/macro/filter), op=action taken (ban/chl/wl). Allowlisted (wl) requests are excluded."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "https"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "http"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 34
      },
      "id": 20,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "HTTP vs HTTPS",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientRequestScheme) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientRequestScheme, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__auto]))",
          "legendFormat": "{{ClientRequestScheme}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Client request scheme distribution. HTTP traffic (red) may indicate misconfigured clients or lack of HTTPS redirect."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlYlRd"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 16,
        "x": 0,
        "y": 42
      },
      "id": 21,
      "options": {
        "basemap": {
          "config": {},
          "name": "Layer 0",
          "type": "default"
        },
        "controls": {
          "mouseWheelZoom": true,
          "showAttribution": true,
          "showDebug": false,
          "showMeasure": false,
          "showScale": false,
          "showZoom": true
        },
        "layers": [
          {
            "config": {
              "color": {
                "field": "Value",
                "fixed": "dark-green"
              },
              "fillOpacity": 0.4,
              "shape": "circle",
              "showLegend": true,
              "size": {
                "field": "Value",
                "fixed": 5,
                "max": 20,
                "min": 3
              }
            },
            "location": {
              "gazetteer": "public/gazetteer/countries.json",
              "lookup": "ClientCountry",
              "mode": "lookup"
            },
            "name": "Markers",
            "type": "markers"
          }
        ],
        "tooltip": {
          "mode": "details"
        },
        "view": {
          "id": "coords",
          "lat": 20,
          "lon": 0,
          "zoom": 1.5
        }
      },
      "title": "Requests by Country (Map)",
      "type": "geomap",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientCountry) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__range]))",
          "legendFormat": "",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "World map showing request volume by client country (ISO 3166-1 Alpha-2). Bubble size = request count."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "ad"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Andorra"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ae"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "United Arab Emirates"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "af"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Afghanistan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ag"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Antigua and Barbuda"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ai"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Anguilla"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "al"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Albania"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "am"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Armenia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ao"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Angola"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "aq"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Antarctica"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ar"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Argentina"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "as"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "American Samoa"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "at"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Austria"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "au"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Australia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "aw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Aruba"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ax"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "\u00c5land Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "az"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Azerbaijan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ba"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bosnia and Herzegovina"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bb"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Barbados"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bd"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bangladesh"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "be"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Belgium"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bf"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Burkina Faso"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bulgaria"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bh"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bahrain"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bi"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Burundi"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bj"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Benin"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bl"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Saint Barth\u00e9lemy"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bermuda"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Brunei Darussalam"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bo"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bolivia, Plurinational State of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bq"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bonaire, Sint Eustatius and Saba"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "br"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Brazil"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bs"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bahamas"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bt"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bhutan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bv"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Bouvet Island"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Botswana"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "by"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Belarus"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "bz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Belize"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ca"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Canada"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cc"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cocos (Keeling) Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cd"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Congo, Democratic Republic of the"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cf"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Central African Republic"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Congo"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ch"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Switzerland"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ci"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "C\u00f4te d'Ivoire"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ck"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cook Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cl"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Chile"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cameroon"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "China"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "co"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Colombia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Costa Rica"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cu"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cuba"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cv"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cabo Verde"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cura\u00e7ao"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cx"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Christmas Island"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cy"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cyprus"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "cz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Czechia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "de"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Germany"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "dj"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Djibouti"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "dk"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Denmark"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "dm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Dominica"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "do"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Dominican Republic"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "dz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Algeria"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ec"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Ecuador"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ee"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Estonia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "eg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Egypt"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "eh"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Western Sahara"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "er"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Eritrea"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "es"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Spain"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "et"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Ethiopia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "fi"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Finland"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "fj"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Fiji"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "fk"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Falkland Islands (Malvinas)"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "fm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Micronesia, Federated States of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "fo"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Faroe Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "fr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "France"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ga"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Gabon"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gb"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "United Kingdom of Great Britain and Northern Ireland"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gd"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Grenada"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ge"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Georgia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gf"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "French Guiana"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Guernsey"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gh"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Ghana"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gi"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Gibraltar"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gl"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Greenland"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Gambia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Guinea"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gp"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Guadeloupe"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gq"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Equatorial Guinea"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Greece"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gs"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "South Georgia and the South Sandwich Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gt"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Guatemala"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gu"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Guam"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Guinea-Bissau"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "gy"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Guyana"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "hk"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Hong Kong"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "hm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Heard Island and McDonald Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "hn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Honduras"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "hr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Croatia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ht"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Haiti"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "hu"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Hungary"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "id"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Indonesia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ie"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Ireland"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "il"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Israel"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "im"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Isle of Man"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "in"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "India"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "io"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "British Indian Ocean Territory"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "iq"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Iraq"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ir"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Iran, Islamic Republic of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "is"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Iceland"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "it"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Italy"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "je"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Jersey"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "jm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Jamaica"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "jo"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Jordan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "jp"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Japan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ke"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Kenya"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "kg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Kyrgyzstan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "kh"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cambodia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ki"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Kiribati"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "km"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Comoros"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "kn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Saint Kitts and Nevis"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "kp"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Korea, Democratic People's Republic of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "kr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Korea, Republic of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "kw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Kuwait"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ky"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Cayman Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "kz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Kazakhstan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "la"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Lao People's Democratic Republic"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "lb"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Lebanon"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "lc"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Saint Lucia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "li"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Liechtenstein"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "lk"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Sri Lanka"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "lr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Liberia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ls"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Lesotho"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "lt"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Lithuania"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "lu"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Luxembourg"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "lv"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Latvia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ly"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Libya"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ma"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Morocco"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mc"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Monaco"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "md"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Moldova, Republic of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "me"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Montenegro"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mf"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Saint Martin (French part)"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Madagascar"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mh"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Marshall Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mk"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "North Macedonia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ml"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Mali"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Myanmar"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Mongolia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mo"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Macao"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mp"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Northern Mariana Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mq"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Martinique"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Mauritania"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ms"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Montserrat"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mt"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Malta"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mu"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Mauritius"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mv"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Maldives"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Malawi"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mx"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Mexico"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "my"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Malaysia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "mz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Mozambique"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "na"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Namibia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "nc"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "New Caledonia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ne"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Niger"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "nf"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Norfolk Island"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ng"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Nigeria"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ni"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Nicaragua"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "nl"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Netherlands, Kingdom of the"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "no"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Norway"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "np"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Nepal"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "nr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Nauru"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "nu"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Niue"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "nz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "New Zealand"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "om"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Oman"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pa"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Panama"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pe"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Peru"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pf"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "French Polynesia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Papua New Guinea"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ph"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Philippines"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pk"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Pakistan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pl"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Poland"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Saint Pierre and Miquelon"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Pitcairn"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Puerto Rico"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ps"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Palestine, State of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pt"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Portugal"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "pw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Palau"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "py"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Paraguay"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "qa"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Qatar"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "re"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "R\u00e9union"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ro"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Romania"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "rs"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Serbia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ru"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Russian Federation"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "rw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Rwanda"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sa"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Saudi Arabia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sb"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Solomon Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sc"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Seychelles"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sd"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Sudan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "se"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Sweden"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Singapore"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sh"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Saint Helena, Ascension and Tristan da Cunha"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "si"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Slovenia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sj"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Svalbard and Jan Mayen"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sk"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Slovakia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sl"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Sierra Leone"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "San Marino"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Senegal"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "so"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Somalia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Suriname"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ss"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "South Sudan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "st"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Sao Tome and Principe"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sv"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "El Salvador"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sx"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Sint Maarten (Dutch part)"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sy"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Syrian Arab Republic"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "sz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Eswatini"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tc"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Turks and Caicos Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "td"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Chad"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tf"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "French Southern Territories"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Togo"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "th"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Thailand"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tj"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Tajikistan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tk"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Tokelau"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tl"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Timor-Leste"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Turkmenistan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Tunisia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "to"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Tonga"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tr"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "T\u00fcrkiye"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tt"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Trinidad and Tobago"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tv"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Tuvalu"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Taiwan, Province of China"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Tanzania, United Republic of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ua"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Ukraine"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ug"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Uganda"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "um"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "United States Minor Outlying Islands"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "us"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "United States of America"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "uy"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Uruguay"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "uz"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Uzbekistan"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "va"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Holy See"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "vc"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Saint Vincent and the Grenadines"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ve"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Venezuela, Bolivarian Republic of"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "vg"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Virgin Islands (British)"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "vi"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Virgin Islands (U.S.)"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "vn"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Viet Nam"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "vu"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Vanuatu"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "wf"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Wallis and Futuna"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ws"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Samoa"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ye"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Yemen"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "yt"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Mayotte"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "za"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "South Africa"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "zm"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Zambia"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "zw"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Zimbabwe"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 10,
        "w": 8,
        "x": 16,
        "y": 42
      },
      "id": 22,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Requests by Country (Top 10)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(10, sum by (ClientCountry) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__auto])))",
          "legendFormat": "{{ClientCountry}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Top 10 countries by request volume over time. Country codes are resolved to full names."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 52
      },
      "id": 23,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Requests by Edge Colo (Top 10)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(10, sum by (EdgeColoCode) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__auto])))",
          "legendFormat": "{{EdgeColoCode}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Top 10 Cloudflare edge data centers (colos) serving requests. IATA airport codes (e.g., SIN=Singapore, NRT=Tokyo)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ClientASN"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "type": "value",
                    "options": {
                      "174": {
                        "text": "AS174 (Cogent Communications LLC)",
                        "index": 0
                      },
                      "577": {
                        "text": "AS577 (Bell Canada)",
                        "index": 1
                      },
                      "701": {
                        "text": "AS701 (Verizon Business)",
                        "index": 2
                      },
                      "714": {
                        "text": "AS714 (Apple Inc.)",
                        "index": 3
                      },
                      "852": {
                        "text": "AS852 (TELUS Communications Inc.)",
                        "index": 4
                      },
                      "1101": {
                        "text": "AS1101 (SURF B.V.)",
                        "index": 5
                      },
                      "1136": {
                        "text": "AS1136 (KPN B.V.)",
                        "index": 6
                      },
                      "1942": {
                        "text": "AS1942 (Renater)",
                        "index": 7
                      },
                      "2586": {
                        "text": "AS2586 (Elisa Eesti)",
                        "index": 8
                      },
                      "3255": {
                        "text": "AS3255 (Uar.net)",
                        "index": 9
                      },
                      "3257": {
                        "text": "AS3257 (GTT Communications Inc.)",
                        "index": 10
                      },
                      "3356": {
                        "text": "AS3356 (Lumen AS3356)",
                        "index": 11
                      },
                      "4134": {
                        "text": "AS4134 (China Telecom)",
                        "index": 12
                      },
                      "4788": {
                        "text": "AS4788 (Telekom Malaysia Berhad (TM))",
                        "index": 13
                      },
                      "4808": {
                        "text": "AS4808 (China Unicom Beijing Province Network)",
                        "index": 14
                      },
                      "4811": {
                        "text": "AS4811 (CHINANET-SHANGHAI-MAN China Telecom Group)",
                        "index": 15
                      },
                      "4818": {
                        "text": "AS4818 (CelcomDigi Telecommunications Sdn Bhd)",
                        "index": 16
                      },
                      "4837": {
                        "text": "AS4837 (AS-CNCGROUP)",
                        "index": 17
                      },
                      "5410": {
                        "text": "AS5410 (Bouygues Telecom SA)",
                        "index": 18
                      },
                      "5466": {
                        "text": "AS5466 (EIRCOM)",
                        "index": 19
                      },
                      "5650": {
                        "text": "AS5650 (frontiernet.net, ftr.com, frontier.com)",
                        "index": 20
                      },
                      "6147": {
                        "text": "AS6147 (INTEGRATEL PERU S.A.A.)",
                        "index": 21
                      },
                      "6206": {
                        "text": "AS6206 (Netrouting)",
                        "index": 22
                      },
                      "6810": {
                        "text": "AS6810 (Bezeq ltd.)",
                        "index": 23
                      },
                      "6830": {
                        "text": "AS6830 (UPC Distribution Services, UPC Broadband, UGC Europe, LGI, chello, aorta)",
                        "index": 24
                      },
                      "7303": {
                        "text": "AS7303 (Telecom Argentina S.A.)",
                        "index": 25
                      },
                      "8075": {
                        "text": "AS8075 (Microsoft Corporation)",
                        "index": 26
                      },
                      "8151": {
                        "text": "AS8151 (UNINET)",
                        "index": 27
                      },
                      "8193": {
                        "text": "AS8193 (BRM-AS)",
                        "index": 28
                      },
                      "8758": {
                        "text": "AS8758 (Iway AG)",
                        "index": 29
                      },
                      "9009": {
                        "text": "AS9009 (Globalaxs Communications - OHTele - Axamba - WebTapestry - SOInternet)",
                        "index": 30
                      },
                      "9299": {
                        "text": "AS9299 (Philippine Long Distance Company)",
                        "index": 31
                      },
                      "9930": {
                        "text": "AS9930 (TTNET-MY TIME dotCom Berhad No. 14, Jalan Majistret U126 Hicom Glenmarie Industrial Park 40150 Shah Alam Selangor, Malaysia)",
                        "index": 32
                      },
                      "10242": {
                        "text": "AS10242 (US Internet Corp)",
                        "index": 33
                      },
                      "10439": {
                        "text": "AS10439 (CariNet Inc.)",
                        "index": 34
                      },
                      "10796": {
                        "text": "AS10796 (Spectrum)",
                        "index": 35
                      },
                      "11664": {
                        "text": "AS11664 (Techtel LMDS Comunicaciones Interactivas S.A.)",
                        "index": 36
                      },
                      "11878": {
                        "text": "AS11878 (TZULO)",
                        "index": 37
                      },
                      "11888": {
                        "text": "AS11888 (Television Internacional, S.A. de C.V.)",
                        "index": 38
                      },
                      "12389": {
                        "text": "AS12389 (PJSC Rostelecom)",
                        "index": 39
                      },
                      "12430": {
                        "text": "AS12430 (VODAFONE ESPANA S.A.U.)",
                        "index": 40
                      },
                      "12552": {
                        "text": "AS12552 (GlobalConnect AB)",
                        "index": 41
                      },
                      "12555": {
                        "text": "AS12555 (IMAQLIQ iqdata.center)",
                        "index": 42
                      },
                      "12816": {
                        "text": "AS12816 (MWN-AS)",
                        "index": 43
                      },
                      "13194": {
                        "text": "AS13194 (Bite Lietuva)",
                        "index": 44
                      },
                      "13213": {
                        "text": "AS13213 (THG Hosting (The Hut Group), 100TB, VPS.net)",
                        "index": 45
                      },
                      "13335": {
                        "text": "AS13335 (Cloudflare Inc.)",
                        "index": 46
                      },
                      "13489": {
                        "text": "AS13489 (UNE EPM TELECOMUNICACIONES S.A.)",
                        "index": 47
                      },
                      "13737": {
                        "text": "AS13737 (Interconnecx, LLC)",
                        "index": 48
                      },
                      "14007": {
                        "text": "AS14007 (Skyway West Business Internet Services)",
                        "index": 49
                      },
                      "14061": {
                        "text": "AS14061 (Digital Ocean)",
                        "index": 50
                      },
                      "14593": {
                        "text": "AS14593 (Space Exploration Technologies Corporation)",
                        "index": 51
                      },
                      "14618": {
                        "text": "AS14618 (Amazon.com Inc.)",
                        "index": 52
                      },
                      "15169": {
                        "text": "AS15169 (Google LLC)",
                        "index": 53
                      },
                      "15704": {
                        "text": "AS15704 (XTRA TELECOM S.A.)",
                        "index": 54
                      },
                      "15802": {
                        "text": "AS15802 (du)",
                        "index": 55
                      },
                      "16276": {
                        "text": "AS16276 (OVHcloud)",
                        "index": 56
                      },
                      "16342": {
                        "text": "AS16342 (TOYA)",
                        "index": 57
                      },
                      "16509": {
                        "text": "AS16509 (Amazon.com Inc.)",
                        "index": 58
                      },
                      "17072": {
                        "text": "AS17072 (Totalplay)",
                        "index": 59
                      },
                      "17621": {
                        "text": "AS17621 (China Unicom Shanghai network)",
                        "index": 60
                      },
                      "17962": {
                        "text": "AS17962 (TOPWAY-NET ShenZhen Topway Video Communication Co. Ltd)",
                        "index": 61
                      },
                      "18779": {
                        "text": "AS18779 (OpenColo)",
                        "index": 62
                      },
                      "18881": {
                        "text": "AS18881 (Vivo)",
                        "index": 63
                      },
                      "19318": {
                        "text": "AS19318 (NJIIX)",
                        "index": 64
                      },
                      "20011": {
                        "text": "AS20011 (Dimension Data)",
                        "index": 65
                      },
                      "20115": {
                        "text": "AS20115 (Spectrum)",
                        "index": 66
                      },
                      "20473": {
                        "text": "AS20473 (The Constant Company LLC)",
                        "index": 67
                      },
                      "22295": {
                        "text": "AS22295 (Advin Servers AS22295)",
                        "index": 68
                      },
                      "22612": {
                        "text": "AS22612 (Namecheap)",
                        "index": 69
                      },
                      "22927": {
                        "text": "AS22927 (TASA)",
                        "index": 70
                      },
                      "23724": {
                        "text": "AS23724 (CHINANET-IDC-BJ-AP IDC, China Telecommunications Corporation)",
                        "index": 71
                      },
                      "24940": {
                        "text": "AS24940 (Hetzner Online GmbH)",
                        "index": 72
                      },
                      "25496": {
                        "text": "AS25496 (ZSR - ZT Bratislava)",
                        "index": 73
                      },
                      "26599": {
                        "text": "AS26599 (Vivo)",
                        "index": 74
                      },
                      "26666": {
                        "text": "AS26666 (INTERSERVER-LAX - Interserver, Inc)",
                        "index": 75
                      },
                      "27651": {
                        "text": "AS27651 (ENTEL CHILE S.A.)",
                        "index": 76
                      },
                      "27738": {
                        "text": "AS27738 (CLARO ECUADOR)",
                        "index": 77
                      },
                      "27901": {
                        "text": "AS27901 (Mundo Pacifico)",
                        "index": 78
                      },
                      "27947": {
                        "text": "AS27947 (Telconet S.A)",
                        "index": 79
                      },
                      "28183": {
                        "text": "AS28183 (MICRON LINE SERVICOS DE INFORMATICA LTDA - ME)",
                        "index": 80
                      },
                      "28573": {
                        "text": "AS28573 (NET/VIRTUA)",
                        "index": 81
                      },
                      "31122": {
                        "text": "AS31122 (Digiweb ltd)",
                        "index": 82
                      },
                      "31898": {
                        "text": "AS31898 (Oracle Cloud Infrastructure)",
                        "index": 83
                      },
                      "32613": {
                        "text": "AS32613 (iWeb Technologies)",
                        "index": 84
                      },
                      "32934": {
                        "text": "AS32934 (Facebook Inc.)",
                        "index": 85
                      },
                      "33915": {
                        "text": "AS33915 (Vodafone Libertel B.V.)",
                        "index": 86
                      },
                      "35369": {
                        "text": "AS35369 (lagis)",
                        "index": 87
                      },
                      "35753": {
                        "text": "AS35753 (Salam Telecom)",
                        "index": 88
                      },
                      "36352": {
                        "text": "AS36352 (ColoCrossing)",
                        "index": 89
                      },
                      "36680": {
                        "text": "AS36680 (NETIFACELLC - Netiface LLC)",
                        "index": 90
                      },
                      "36903": {
                        "text": "AS36903 (MT-MPLS)",
                        "index": 91
                      },
                      "36947": {
                        "text": "AS36947 (Algeria Telecom)",
                        "index": 92
                      },
                      "37105": {
                        "text": "AS37105 (rain)",
                        "index": 93
                      },
                      "37611": {
                        "text": "AS37611 (Afrihost)",
                        "index": 94
                      },
                      "38235": {
                        "text": "AS38235 (MekongNet)",
                        "index": 95
                      },
                      "38631": {
                        "text": "AS38631 (LINE LY Corporation)",
                        "index": 96
                      },
                      "40028": {
                        "text": "AS40028 (1651884 Ontario Inc.)",
                        "index": 97
                      },
                      "42682": {
                        "text": "AS42682 (ERTH-NNOV-AS)",
                        "index": 98
                      },
                      "42708": {
                        "text": "AS42708 (Portlane)",
                        "index": 99
                      },
                      "43289": {
                        "text": "AS43289 (TRABIA)",
                        "index": 100
                      },
                      "44684": {
                        "text": "AS44684 (Mythic Beasts Ltd)",
                        "index": 101
                      },
                      "45090": {
                        "text": "AS45090 (QQ)",
                        "index": 102
                      },
                      "45102": {
                        "text": "AS45102 (Alibaba)",
                        "index": 103
                      },
                      "45899": {
                        "text": "AS45899 (VNPT)",
                        "index": 104
                      },
                      "46261": {
                        "text": "AS46261 (QUICKPACKET)",
                        "index": 105
                      },
                      "46375": {
                        "text": "AS46375 (Sonic Telecom LLC)",
                        "index": 106
                      },
                      "48090": {
                        "text": "AS48090 (DMZHOST)",
                        "index": 107
                      },
                      "49825": {
                        "text": "AS49825 (LNTK)",
                        "index": 108
                      },
                      "50219": {
                        "text": "AS50219 (VT-255-50219 - Valence Technology Co.)",
                        "index": 109
                      },
                      "51167": {
                        "text": "AS51167 (CONTABO)",
                        "index": 110
                      },
                      "51396": {
                        "text": "AS51396 (Pfcloud UG (haftungsbeschr\u00e4nkt))",
                        "index": 111
                      },
                      "51747": {
                        "text": "AS51747 (Internet Vikings International)",
                        "index": 112
                      },
                      "52228": {
                        "text": "AS52228 (Liberty Servicios Fijos LY, S.A.)",
                        "index": 113
                      },
                      "52607": {
                        "text": "AS52607 (Irmaos Giotto Oliveira & Cia.Ltda.)",
                        "index": 114
                      },
                      "52765": {
                        "text": "AS52765 (Maxxnet Telecomunicacoes LTDA)",
                        "index": 115
                      },
                      "52864": {
                        "text": "AS52864 (Fillnet Com. e Ser. LTDA)",
                        "index": 116
                      },
                      "53514": {
                        "text": "AS53514 (UHQ - UHQ Services LLC)",
                        "index": 117
                      },
                      "53667": {
                        "text": "AS53667 (FranTech Solutions)",
                        "index": 118
                      },
                      "54103": {
                        "text": "AS54103 (MOD Mission Critical)",
                        "index": 119
                      },
                      "55967": {
                        "text": "AS55967 (BAIDU Beijing Baidu Netcom Science and Technology Co., Ltd.)",
                        "index": 120
                      },
                      "56971": {
                        "text": "AS56971 (AS56971 AS56971 Cloud)",
                        "index": 121
                      },
                      "58461": {
                        "text": "AS58461 (No.288 Fu-chun Road)",
                        "index": 122
                      },
                      "58519": {
                        "text": "AS58519 (CHINATELECOM-CTCLOUD Cloud Computing Corporation)",
                        "index": 123
                      },
                      "59625": {
                        "text": "AS59625 (KorekTel)",
                        "index": 124
                      },
                      "60068": {
                        "text": "AS60068 (CDN77.com)",
                        "index": 125
                      },
                      "60781": {
                        "text": "AS60781 (LeaseWeb Netherlands B.V.)",
                        "index": 126
                      },
                      "61621": {
                        "text": "AS61621 (Norte.Net Internet Rural)",
                        "index": 127
                      },
                      "61741": {
                        "text": "AS61741 (FG INTERLIGA LTDA)",
                        "index": 128
                      },
                      "61917": {
                        "text": "AS61917 (NETMAIS TELECOM LTDA)",
                        "index": 129
                      },
                      "61942": {
                        "text": "AS61942 (TURBONET TELECOM LTDA)",
                        "index": 130
                      },
                      "62240": {
                        "text": "AS62240 (Clouvider Limited)",
                        "index": 131
                      },
                      "62874": {
                        "text": "AS62874 (Web2Objects Global)",
                        "index": 132
                      },
                      "63018": {
                        "text": "AS63018 (Dedicated.com)",
                        "index": 133
                      },
                      "63473": {
                        "text": "AS63473 (HostHatch LLC)",
                        "index": 134
                      },
                      "63838": {
                        "text": "AS63838 (CT-HUNAN-HENGYANG-IDC Hengyang)",
                        "index": 135
                      },
                      "64286": {
                        "text": "AS64286 (LOGICWEB)",
                        "index": 136
                      },
                      "132203": {
                        "text": "AS132203 (Shenzhen Tencent Computer Systems Company Limited)",
                        "index": 137
                      },
                      "132892": {
                        "text": "AS132892 (Cloudflare Inc.)",
                        "index": 138
                      },
                      "133296": {
                        "text": "AS133296 (Web Werks DataCenter)",
                        "index": 139
                      },
                      "134760": {
                        "text": "AS134760 (Shijiazhuang IDC network CHINANET Hebei province)",
                        "index": 140
                      },
                      "134952": {
                        "text": "AS134952 (Smart Online)",
                        "index": 141
                      },
                      "135661": {
                        "text": "AS135661 (Superior Connections)",
                        "index": 142
                      },
                      "135882": {
                        "text": "AS135882 (Asifur Rahman Fahim)",
                        "index": 143
                      },
                      "136418": {
                        "text": "AS136418 (Blueberry Online)",
                        "index": 144
                      },
                      "136907": {
                        "text": "AS136907 (HUAWEI INTERNATIONAL PTE. LTD.)",
                        "index": 145
                      },
                      "137409": {
                        "text": "AS137409 (Global Secure Layer, GSL Networks)",
                        "index": 146
                      },
                      "137687": {
                        "text": "AS137687 (CHINATELECOM-HENAN-LUOYANG-IDC Luoyang, Henan Province, P.R.China.)",
                        "index": 147
                      },
                      "139952": {
                        "text": "AS139952 (PT Trisari Data Indonusa)",
                        "index": 148
                      },
                      "140577": {
                        "text": "AS140577 (Ahrefs PTE Ltd)",
                        "index": 149
                      },
                      "141995": {
                        "text": "AS141995 (Contabo Asia)",
                        "index": 150
                      },
                      "149178": {
                        "text": "AS149178 (CT-HEFEI-NANGANG-IDC China Telecom)",
                        "index": 151
                      },
                      "150436": {
                        "text": "AS150436 (Byteplus Pte. Ltd.)",
                        "index": 152
                      },
                      "152194": {
                        "text": "AS152194 (CTGSERVERLIMITED-AS-AP CTG Server Limited)",
                        "index": 153
                      },
                      "152479": {
                        "text": "AS152479 (DSACL-AS-AP DELTA SOFTWARE AND COMMUNICATION LIMITED)",
                        "index": 154
                      },
                      "153671": {
                        "text": "AS153671 (LiaSail NET)",
                        "index": 155
                      },
                      "198488": {
                        "text": "AS198488 (NBU-AS)",
                        "index": 156
                      },
                      "199404": {
                        "text": "AS199404 (WHG Hosting Services Ltd)",
                        "index": 157
                      },
                      "200373": {
                        "text": "AS200373 (3xK Tech)",
                        "index": 158
                      },
                      "202623": {
                        "text": "AS202623 (CLOUDFLARENET-CORE Cloudflare, Inc.)",
                        "index": 159
                      },
                      "203061": {
                        "text": "AS203061 (itproximus)",
                        "index": 160
                      },
                      "204957": {
                        "text": "AS204957 (GREEN FLOID LLC)",
                        "index": 161
                      },
                      "206092": {
                        "text": "AS206092 (SECFIREWALLAS)",
                        "index": 162
                      },
                      "207990": {
                        "text": "AS207990 (HostRoyale Technologies Pvt Ltd)",
                        "index": 163
                      },
                      "208137": {
                        "text": "AS208137 (Feo Prest SRL)",
                        "index": 164
                      },
                      "209366": {
                        "text": "AS209366 (SEMRUSH-AS)",
                        "index": 165
                      },
                      "209605": {
                        "text": "AS209605 (hostbaltic)",
                        "index": 166
                      },
                      "210259": {
                        "text": "AS210259 (APCOTECH)",
                        "index": 167
                      },
                      "210558": {
                        "text": "AS210558 (1337 Services GmbH)",
                        "index": 168
                      },
                      "210743": {
                        "text": "AS210743 (Babbar SAS)",
                        "index": 169
                      },
                      "211298": {
                        "text": "AS211298 (DRIFTNET)",
                        "index": 170
                      },
                      "211590": {
                        "text": "AS211590 (Bucklog SARL)",
                        "index": 171
                      },
                      "212238": {
                        "text": "AS212238 (CDNEXT)",
                        "index": 172
                      },
                      "213412": {
                        "text": "AS213412 (ONYPHE SAS)",
                        "index": 173
                      },
                      "213438": {
                        "text": "AS213438 (ColocaTel Inc.)",
                        "index": 174
                      },
                      "213790": {
                        "text": "AS213790 (LimitedNetwork-AS)",
                        "index": 175
                      },
                      "214669": {
                        "text": "AS214669 (STARLIGHT TECH TRADING CO. LIMITED)",
                        "index": 176
                      },
                      "214996": {
                        "text": "AS214996 (netcup)",
                        "index": 177
                      },
                      "215540": {
                        "text": "AS215540 (GLOBAL CONNECTIVITY SOLUTIONS LLP)",
                        "index": 178
                      },
                      "215925": {
                        "text": "AS215925 (VPSVAULTHOST)",
                        "index": 179
                      },
                      "216071": {
                        "text": "AS216071 (SERVERS TECH FZCO)",
                        "index": 180
                      },
                      "262409": {
                        "text": "AS262409 (Click82 Telecom)",
                        "index": 181
                      },
                      "262470": {
                        "text": "AS262470 (Pontenet Teleinform\u00e1tica Ltda.)",
                        "index": 182
                      },
                      "262645": {
                        "text": "AS262645 (BrasilNET Telecomunica\u00e7\u00f5es do Parana LTDA)",
                        "index": 183
                      },
                      "262753": {
                        "text": "AS262753 (VOCE TELECOMUNICACOES LTDA)",
                        "index": 184
                      },
                      "264075": {
                        "text": "AS264075 (K1 Telecom)",
                        "index": 185
                      },
                      "265475": {
                        "text": "AS265475 (265475)",
                        "index": 186
                      },
                      "266566": {
                        "text": "AS266566 (Stamp Provedor de Internet & TV)",
                        "index": 187
                      },
                      "267790": {
                        "text": "AS267790 (NET ISP S.A.S)",
                        "index": 188
                      },
                      "267904": {
                        "text": "AS267904 (TELEVISORA DEL SUR SAC)",
                        "index": 189
                      },
                      "269405": {
                        "text": "AS269405 (CONECT TEC TELECOMUNICACOES LTDA)",
                        "index": 190
                      },
                      "269617": {
                        "text": "AS269617 (Solutions Telecom Provedor de Internet LTDA - ME)",
                        "index": 191
                      },
                      "270838": {
                        "text": "AS270838 (Neidnet Telecomunicacoes)",
                        "index": 192
                      },
                      "270915": {
                        "text": "AS270915 (Nova Web Telecom)",
                        "index": 193
                      },
                      "328638": {
                        "text": "AS328638 (Letaba Networks (Pty) Ltd)",
                        "index": 194
                      },
                      "393886": {
                        "text": "AS393886 (LeaseWeb USA / MIA-01)",
                        "index": 195
                      },
                      "395954": {
                        "text": "AS395954 (LeaseWeb USA / LAX-12)",
                        "index": 196
                      },
                      "396982": {
                        "text": "AS396982 (Google LLC)",
                        "index": 197
                      },
                      "398324": {
                        "text": "AS398324 (Censys)",
                        "index": 198
                      },
                      "398705": {
                        "text": "AS398705 (CENSYS-ARIN-02 - Censys, Inc.)",
                        "index": 199
                      },
                      "398722": {
                        "text": "AS398722 (CENSYS-ARIN-03 - Censys, Inc.)",
                        "index": 200
                      },
                      "399629": {
                        "text": "AS399629 (BLNWX - BL Networks)",
                        "index": 201
                      },
                      "401560": {
                        "text": "AS401560 (OneCable Network LLC)",
                        "index": 202
                      },
                      "401626": {
                        "text": "AS401626 (NETIFACE-TORONTO - Netiface America, Inc.)",
                        "index": 203
                      }
                    }
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 52
      },
      "id": 24,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top Client ASNs",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(25, sum by (ClientASN) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__range])))",
          "legendFormat": "{{ClientASN}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Top 25 Autonomous System Numbers by request count. ASN names resolved via Cloudflare Radar API."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 60
      },
      "id": 25,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Client Device Type",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientDeviceType) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientDeviceType, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | ClientDeviceType != `` [$__auto]))",
          "legendFormat": "{{ClientDeviceType}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Device type classification (desktop, mobile, tablet) based on User-Agent parsing."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 16,
        "x": 8,
        "y": 60
      },
      "id": 26,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top Referers",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(25, sum by (ClientRequestReferer) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientRequestReferer, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | ClientRequestReferer != `` [$__range])))",
          "legendFormat": "{{ClientRequestReferer}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Top referring URLs. Empty referers are excluded. Uses approx_topk for high-cardinality referer data."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 68
      },
      "id": 27,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Client SSL Protocol",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientSSLProtocol) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientSSLProtocol, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | ClientSSLProtocol != `` | ClientSSLProtocol != `none` [$__auto]))",
          "legendFormat": "{{ClientSSLProtocol}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "TLS protocol version used between client and Cloudflare edge (TLSv1.2, TLSv1.3)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 68
      },
      "id": 28,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Client SSL Cipher",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(15, sum by (ClientSSLCipher) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientSSLCipher, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | ClientSSLCipher != `` | ClientSSLCipher != `NONE` [$__auto])))",
          "legendFormat": "{{ClientSSLCipher}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "TLS cipher suites negotiated between client and edge. Top 15 by request count."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 68
      },
      "id": 29,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Origin SSL Protocol",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (OriginSSLProtocol) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginSSLProtocol, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | OriginSSLProtocol != `` | OriginSSLProtocol != `none` [$__auto]))",
          "legendFormat": "{{OriginSSLProtocol}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "TLS protocol version used between Cloudflare edge and origin server."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "ok"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "absent"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "untrusted"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "expired"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 76
      },
      "id": 30,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "mTLS Authentication Status",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientMTLSAuthStatus) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientMTLSAuthStatus, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | ClientMTLSAuthStatus != `` | ClientMTLSAuthStatus != `unknown` [$__auto]))",
          "legendFormat": "{{ClientMTLSAuthStatus}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Mutual TLS client certificate validation results. 'ok'=valid cert, 'absent'=no cert presented, 'untrusted'/'expired'=invalid cert."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 76
      },
      "id": 31,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Content Scan Results",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ContentScanObjResults, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | ContentScanObjResults != `` | ContentScanObjResults != `[]` [$__auto]))",
          "legendFormat": "Scanned Objects",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Cloudflare content scanning detections (malware, DLP) on request/response payloads."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 18,
        "y": 76
      },
      "id": 32,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "O2O (Orange-to-Orange) Traffic",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeCFConnectingO2O, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | EdgeCFConnectingO2O = `true` [$__auto]))",
          "legendFormat": "O2O Requests",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Requests proxied through another Cloudflare zone before reaching this zone (orange-to-orange)."
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 84
      },
      "id": 33,
      "panels": [],
      "title": "Performance",
      "type": "row",
      "description": "Request lifecycle timing: client-edge RTT, edge processing (WAF/cache), and edge-origin latency."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 50,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Client \u2192 Edge (TCP RTT)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Edge Processing"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Edge \u2192 Origin (total)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 85
      },
      "id": 34,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Request Lifecycle Breakdown (avg ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientTCPRTTMs, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap ClientTCPRTTMs [$__auto]))",
          "legendFormat": "Client \u2192 Edge (TCP RTT)",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto])) - sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "Edge Processing",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "Edge \u2192 Origin (total)",
          "refId": "C",
          "queryType": "range"
        }
      ],
      "description": "Stacked breakdown of where request time is spent. Client\u2192Edge = TCP RTT. Edge Processing = TTFB minus origin duration (WAF, bot checks, cache lookup). Edge\u2192Origin = total origin fetch time."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Avg"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p50 (median)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p75"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "super-light-yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p90"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p95"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p99"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 93
      },
      "id": 35,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge TTFB \u2014 End to End (ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto]))",
          "legendFormat": "Avg",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.50, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto]))",
          "legendFormat": "p50 (median)",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.75, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto]))",
          "legendFormat": "p75",
          "refId": "C",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.90, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto]))",
          "legendFormat": "p90",
          "refId": "D",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.95, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto]))",
          "legendFormat": "p95",
          "refId": "E",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.99, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto]))",
          "legendFormat": "p99",
          "refId": "F",
          "queryType": "range"
        }
      ],
      "description": "End-to-end Time To First Byte: from after TCP handshake to first byte sent to the client. Includes TLS negotiation, WAF processing, cache lookup, and origin response time."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Avg"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p50 (median)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p75"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "super-light-yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p90"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p95"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p99"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 93
      },
      "id": 36,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Origin Response Duration (ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "Avg",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.50, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p50 (median)",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.75, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p75",
          "refId": "C",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.90, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p90",
          "refId": "D",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.95, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p95",
          "refId": "E",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.99, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p99",
          "refId": "F",
          "queryType": "range"
        }
      ],
      "description": "Total time for edge-to-origin request cycle: DNS resolution, TCP/TLS handshake, request send, and response receive. Includes Argo Smart Routing and Tiered Cache."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Avg"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p50 (median)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p75"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "super-light-yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p90"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p95"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p99"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 101
      },
      "id": 37,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Client \u2192 Edge: TCP RTT (ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientTCPRTTMs, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap ClientTCPRTTMs [$__auto]))",
          "legendFormat": "Avg",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.50, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientTCPRTTMs, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap ClientTCPRTTMs [$__auto]))",
          "legendFormat": "p50 (median)",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.75, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientTCPRTTMs, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap ClientTCPRTTMs [$__auto]))",
          "legendFormat": "p75",
          "refId": "C",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.90, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientTCPRTTMs, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap ClientTCPRTTMs [$__auto]))",
          "legendFormat": "p90",
          "refId": "D",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.95, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientTCPRTTMs, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap ClientTCPRTTMs [$__auto]))",
          "legendFormat": "p95",
          "refId": "E",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.99, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientTCPRTTMs, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap ClientTCPRTTMs [$__auto]))",
          "legendFormat": "p99",
          "refId": "F",
          "queryType": "range"
        }
      ],
      "description": "TCP round-trip time between the client and Cloudflare edge. Reflects geographic distance and network quality. Not affected by server-side processing."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Avg"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p50 (median)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p75"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "super-light-yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p90"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p95"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "p99"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 101
      },
      "id": 38,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge Processing Time (ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto])) - sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "Avg",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.50, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto])) - sum(quantile_over_time(0.50, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p50 (median)",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.75, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto])) - sum(quantile_over_time(0.75, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p75",
          "refId": "C",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.90, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto])) - sum(quantile_over_time(0.90, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p90",
          "refId": "D",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.95, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto])) - sum(quantile_over_time(0.95, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p95",
          "refId": "E",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.99, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto])) - sum(quantile_over_time(0.99, {job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "p99",
          "refId": "F",
          "queryType": "range"
        }
      ],
      "description": "Derived metric: EdgeTimeToFirstByteMs minus OriginResponseDurationMs. Represents time spent on WAF rules, bot detection, cache lookup, and request routing at the edge."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 50,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "DNS Lookup"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "TCP Handshake"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "TLS Handshake"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Header Send"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Header Receive"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "purple",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 109
      },
      "id": 39,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge \u2192 Origin Timing Breakdown (avg ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginDNSResponseTimeMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginDNSResponseTimeMs [$__auto]))",
          "legendFormat": "DNS Lookup",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginTCPHandshakeDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginTCPHandshakeDurationMs [$__auto]))",
          "legendFormat": "TCP Handshake",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginTLSHandshakeDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginTLSHandshakeDurationMs [$__auto]))",
          "legendFormat": "TLS Handshake",
          "refId": "C",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginRequestHeaderSendDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginRequestHeaderSendDurationMs [$__auto]))",
          "legendFormat": "Header Send",
          "refId": "D",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseHeaderReceiveDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseHeaderReceiveDurationMs [$__auto]))",
          "legendFormat": "Header Receive",
          "refId": "E",
          "queryType": "range"
        }
      ],
      "description": "Stacked sub-components of edge-to-origin time: DNS resolution, TCP handshake, TLS handshake, request header send, and response header receive."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 109
      },
      "id": 40,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge \u2192 Origin by Host (avg ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "avg by (ClientRequestHost) (avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto]))",
          "legendFormat": "{{ClientRequestHost}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Average origin response duration per zone. Helps identify which hosts have slow origin servers."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 117
      },
      "id": 41,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge TTFB by Host (avg ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "avg by (ClientRequestHost) (avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto]))",
          "legendFormat": "{{ClientRequestHost}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Average end-to-end TTFB per zone. Compare with origin duration to see how much time is edge overhead vs origin."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 117
      },
      "id": 42,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Client \u2192 Edge RTT by Host (avg ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "avg by (ClientRequestHost) (avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientTCPRTTMs, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap ClientTCPRTTMs [$__auto]))",
          "legendFormat": "{{ClientRequestHost}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Average client TCP RTT per zone. Reflects the geographic distribution of each zone's audience."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 125
      },
      "id": 43,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge TTFB by ASN (avg ms, Top 10)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(10, avg by (ClientASN) (avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeTimeToFirstByteMs, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeTimeToFirstByteMs [$__auto])))",
          "legendFormat": "AS{{ClientASN}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Average TTFB for the top 10 ASNs by latency. Identifies networks with consistently slow end-to-end performance."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 125
      },
      "id": 44,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge \u2192 Origin by ASN (avg ms, Top 10)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(10, avg by (ClientASN) (avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginResponseDurationMs, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap OriginResponseDurationMs [$__auto])))",
          "legendFormat": "AS{{ClientASN}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Average origin response duration for top 10 ASNs. High values here may indicate origin routing issues or geographic distance to origin."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 133
      },
      "id": 45,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Origin Error Rate by IP (5xx)",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(20, sum by (OriginIP) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, OriginIP, OriginResponseStatus, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | OriginResponseStatus >= 500 [$__range])))",
          "legendFormat": "{{OriginIP}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Origin server IPs returning the most 5xx errors. Helps identify unhealthy origin instances."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 133
      },
      "id": 46,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Origin vs Edge Status Mismatch",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(10, sum by (EdgeResponseStatus) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeResponseStatus, JA4, OriginResponseStatus, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | OriginResponseStatus > 0 | EdgeResponseStatus >= 400 [$__auto])))",
          "legendFormat": "edge={{EdgeResponseStatus}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Cases where edge returned 4xx/5xx. Grouped by edge status code. Filtered to requests that hit origin (OriginResponseStatus > 0)."
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 141
      },
      "id": 47,
      "panels": [],
      "title": "Cache Performance",
      "type": "row"
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "hit"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "miss"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "dynamic"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "expired"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 142
      },
      "id": 48,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Cache Status Over Time",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (CacheCacheStatus) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus != `` [$__auto]))",
          "legendFormat": "{{CacheCacheStatus}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Cache status distribution over time: hit, miss, dynamic (uncacheable), expired, revalidated, etc."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": []
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "hit"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "miss"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "dynamic"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "expired"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 142
      },
      "id": 49,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "values": [
            "value",
            "percent"
          ]
        },
        "pieType": "donut",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "title": "Cache Status Distribution",
      "type": "piechart",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (CacheCacheStatus) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus != `` [$__auto]))",
          "legendFormat": "{{CacheCacheStatus}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Overall cache status proportions. 'dynamic' = not eligible for caching. 'hit' = served from cache."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 18,
        "y": 142
      },
      "id": 50,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Cache Hit Ratio Over Time",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus = `hit` [$__auto])) / sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus != `` [$__auto])) * 100",
          "legendFormat": "Hit %",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Cache hit ratio (%) over time. Only includes cacheable requests (excludes empty cache status)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 150
      },
      "id": 51,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Cache Hit Ratio by Host (%)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientRequestHost) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus = `hit` [$__auto])) / sum by (ClientRequestHost) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus != `` [$__auto])) * 100",
          "legendFormat": "{{ClientRequestHost}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Cache hit ratio per zone. Helps identify which zones benefit most from caching."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ClientRequestPath"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 350
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "displayName",
                "value": "Hit %"
              },
              {
                "id": "unit",
                "value": "percent"
              },
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 12,
        "y": 150
      },
      "id": 52,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Cache Hit Ratio by Path (Top 10, %)",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(10, sum by (ClientRequestPath) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus = `hit` [$__range])) / sum by (ClientRequestPath) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheCacheStatus, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheCacheStatus != `` [$__range])) * 100)",
          "legendFormat": "{{ClientRequestPath}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Cache hit ratio for the top 10 paths by cacheability (instant query over selected range). Uses approx_topk to avoid high-cardinality series explosion."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 158
      },
      "id": 53,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Tiered Cache Fill Rate",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheTieredFill, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheTieredFill = `true` [$__auto]))",
          "legendFormat": "Tiered Fill",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheReserveUsed, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | CacheReserveUsed = `true` [$__auto]))",
          "legendFormat": "Cache Reserve",
          "refId": "B",
          "queryType": "range"
        }
      ],
      "description": "Requests served via Tiered Cache (upper-tier colo) or Cache Reserve (persistent storage)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 158
      },
      "id": 54,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Edge Response Bytes",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(sum_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeResponseBytes, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeResponseBytes [$__auto]))",
          "legendFormat": "Total Bytes",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Total bytes sent from edge to clients over time."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 158
      },
      "id": 55,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Cache Response Bytes",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(sum_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json CacheResponseBytes, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap CacheResponseBytes [$__auto]))",
          "legendFormat": "Cached Bytes",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Bytes served from cache over time. Compare with edge response bytes to see bandwidth savings."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": []
        },
        "overrides": []
      },
      "gridPos": {
        "h": 10,
        "w": 8,
        "x": 0,
        "y": 166
      },
      "id": 56,
      "options": {
        "displayLabels": [
          "percent"
        ],
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "values": [
            "value",
            "percent"
          ]
        },
        "pieType": "donut",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "tooltip": {
          "mode": "single",
          "sort": "none"
        }
      },
      "title": "Content Type Distribution",
      "type": "piechart",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(10, sum by (EdgeResponseContentType) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeResponseContentType, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | EdgeResponseContentType != `` [$__auto])))",
          "legendFormat": "{{EdgeResponseContentType}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Top 10 response content types (text/html, image/png, application/json, etc.)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 166
      },
      "id": 57,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Compression Ratio (avg)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, EdgeResponseCompressionRatio, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap EdgeResponseCompressionRatio [$__auto]))",
          "legendFormat": "Avg Ratio",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Average compression ratio of edge responses. Higher = more compression. 1.0 = no compression."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Smart Routed"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Direct"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 166
      },
      "id": 58,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Smart Route / Argo Usage",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, SmartRouteColoID, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | SmartRouteColoID > 0 [$__auto]))",
          "legendFormat": "Smart Routed",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, SmartRouteColoID, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | SmartRouteColoID = 0 [$__auto]))",
          "legendFormat": "Direct",
          "refId": "B",
          "queryType": "range"
        }
      ],
      "description": "Requests routed via Argo Smart Routing (optimized path) vs direct edge-to-origin. SmartRouteColoID > 0 indicates smart routing."
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 176
      },
      "id": 59,
      "panels": [],
      "title": "Security & Firewall",
      "type": "row"
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "block"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "challenge"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "managed_challenge"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "js_challenge"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "purple",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "log"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "skip"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 177
      },
      "id": 60,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Firewall Events by Action",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (Action) (count_over_time({job=\"cloudflare-logpush\", dataset=\"firewall_events\"} | json Action, ClientIP, ClientRequestHost | ClientRequestHost =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientIP =~ \"$ip\" [$__auto]))",
          "legendFormat": "{{Action}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Firewall events grouped by action taken: block, challenge, managed_challenge, js_challenge, log, skip."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 177
      },
      "id": 61,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Firewall Events by Source",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (Source) (count_over_time({job=\"cloudflare-logpush\", dataset=\"firewall_events\"} | json ClientIP, ClientRequestHost, Source | ClientRequestHost =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientIP =~ \"$ip\" [$__auto]))",
          "legendFormat": "{{Source}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Which Cloudflare security product triggered the firewall event (WAF, rate limiting, IP access rules, etc.)."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 185
      },
      "id": 62,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top Firewall Client IPs",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(20, sum by (ClientIP) (count_over_time({job=\"cloudflare-logpush\", dataset=\"firewall_events\"} | json ClientIP, ClientRequestHost | ClientRequestHost =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientIP =~ \"$ip\" [$__range])))",
          "legendFormat": "{{ClientIP}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Client IPs triggering the most firewall events. Candidates for IP access rules."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 185
      },
      "id": 63,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top Firewall Rules",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(20, sum by (RuleID, Description) (count_over_time({job=\"cloudflare-logpush\", dataset=\"firewall_events\"} | json ClientIP, ClientRequestHost, Description, RuleID | ClientRequestHost =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientIP =~ \"$ip\" [$__range])))",
          "legendFormat": "{{RuleID}} - {{Description}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Most-triggered firewall rules by event count. Review rules with high 'log' counts for potential escalation to 'block'."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 185
      },
      "id": 64,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Firewall Events by Host",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientRequestHost) (count_over_time({job=\"cloudflare-logpush\", dataset=\"firewall_events\"} | json ClientIP, ClientRequestHost | ClientRequestHost =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientIP =~ \"$ip\" [$__auto]))",
          "legendFormat": "{{ClientRequestHost}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Firewall event distribution across zones. Identifies which hosts are most targeted."
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 193
      },
      "id": 65,
      "panels": [],
      "title": "WAF Attack Analysis",
      "type": "row"
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "High Risk (1-20)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Medium Risk (21-50)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Low Risk (51+)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 194
      },
      "id": 66,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "WAF Attack Score Buckets",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, WAFAttackScore, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | WAFAttackScore > 0 | WAFAttackScore <= 20 [$__auto]))",
          "legendFormat": "High Risk (1-20)",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, WAFAttackScore, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | WAFAttackScore > 20 | WAFAttackScore <= 50 [$__auto]))",
          "legendFormat": "Medium Risk (21-50)",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, WAFAttackScore, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | WAFAttackScore > 50 [$__auto]))",
          "legendFormat": "Low Risk (51+)",
          "refId": "C",
          "queryType": "range"
        }
      ],
      "description": "Cloudflare WAF attack score distribution. Score 1-20 = high confidence attack. Score 51+ = likely legitimate. Score 0 = not evaluated."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "SQLi"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "XSS"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "RCE"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "purple",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 194
      },
      "id": 67,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Attack Type Breakdown (score <= 20)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, WAFSQLiAttackScore, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | WAFSQLiAttackScore > 0 | WAFSQLiAttackScore <= 20 [$__auto]))",
          "legendFormat": "SQLi",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, WAFXSSAttackScore, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | WAFXSSAttackScore > 0 | WAFXSSAttackScore <= 20 [$__auto]))",
          "legendFormat": "XSS",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, WAFRCEAttackScore, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | WAFRCEAttackScore > 0 | WAFRCEAttackScore <= 20 [$__auto]))",
          "legendFormat": "RCE",
          "refId": "C",
          "queryType": "range"
        }
      ],
      "description": "High-risk attacks (score <= 20) broken down by type: SQL injection, cross-site scripting, remote code execution."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 202
      },
      "id": 68,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Unmitigated Attacks (WAF score<=20, not blocked)",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(20, sum by (ClientRequestPath, ClientRequestHost) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, SecurityAction, WAFAttackScore, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | WAFAttackScore > 0 | WAFAttackScore <= 20 | SecurityAction = `` [$__range])))",
          "legendFormat": "{{ClientRequestHost}}{{ClientRequestPath}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "GAP ANALYSIS: High-risk attack traffic (WAF score 1-20) that was NOT blocked or challenged. Empty SecurityAction = no mitigation applied. Review these paths for WAF rule gaps."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 202
      },
      "id": 69,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Security Rule Efficacy",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "topk(30, sum by (SecurityRuleID, SecurityRuleDescription, SecurityAction) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, SecurityAction, SecurityRuleDescription, SecurityRuleID, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | SecurityRuleID != `` [$__range])))",
          "legendFormat": "{{SecurityRuleID}} {{SecurityRuleDescription}} [{{SecurityAction}}]",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "All triggered security rules with their action. Review 'log' actions for rules that should be escalated to 'block'."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "block"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "challenge"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "managedChallenge"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "log"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "skip"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 210
      },
      "id": 70,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Security Actions on HTTP Requests",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (SecurityAction) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, SecurityAction, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | SecurityAction != `` [$__auto]))",
          "legendFormat": "{{SecurityAction}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "All security actions applied to HTTP requests over time. Sourced from the http_requests dataset SecurityAction field."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "badHost"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "scan"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "tor"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "purple",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "searchEngine"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "monitoringService"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 210
      },
      "id": 71,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Client IP Classification",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ClientIPClass) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientIPClass, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | ClientIPClass != `noRecord` | ClientIPClass != `` [$__auto]))",
          "legendFormat": "{{ClientIPClass}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Cloudflare IP threat intelligence classification. badHost = known malicious, scan = scanner, tor = Tor exit node, searchEngine = legitimate crawler."
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 218
      },
      "id": 72,
      "panels": [],
      "title": "Threat Intelligence",
      "type": "row"
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "password_leaked"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "username_and_password_leaked"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "username_leaked"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "username_password_similar"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 219
      },
      "id": 73,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Leaked Credential Check Results",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (LeakedCredentialCheckResult) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, LeakedCredentialCheckResult, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | LeakedCredentialCheckResult != `` | LeakedCredentialCheckResult != `clean` [$__auto]))",
          "legendFormat": "{{LeakedCredentialCheckResult}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Cloudflare Leaked Credential Check results. Detects credentials found in known breach databases. MITRE ATT&CK T1110.004."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 219
      },
      "id": 74,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Fraud Detection",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, FraudAttack, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | FraudAttack != `` [$__auto]))",
          "legendFormat": "Fraud Attacks",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Cloudflare fraud detection signals on incoming requests."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 227
      },
      "id": 75,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top Talkers (by request count)",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(25, sum by (ClientIP) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" [$__range])))",
          "legendFormat": "{{ClientIP}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Top 25 client IPs by total request volume. High-volume IPs may be bots, scrapers, or DDoS sources."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 227
      },
      "id": 76,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Suspicious UAs (BotScore < 30)",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(20, sum by (ClientRequestUserAgent) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json BotScore, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, ClientRequestUserAgent, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | BotScore > 0 | BotScore < 30 [$__range])))",
          "legendFormat": "{{ClientRequestUserAgent}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "User-Agent strings with low bot scores (1-29 = likely automated). Identify scraping tools, vulnerability scanners, and fake browsers."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "ClientCountry"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "type": "value",
                    "options": {
                      "ad": {
                        "text": "Andorra (AD)",
                        "index": 0
                      },
                      "ae": {
                        "text": "United Arab Emirates (AE)",
                        "index": 1
                      },
                      "af": {
                        "text": "Afghanistan (AF)",
                        "index": 2
                      },
                      "ag": {
                        "text": "Antigua and Barbuda (AG)",
                        "index": 3
                      },
                      "ai": {
                        "text": "Anguilla (AI)",
                        "index": 4
                      },
                      "al": {
                        "text": "Albania (AL)",
                        "index": 5
                      },
                      "am": {
                        "text": "Armenia (AM)",
                        "index": 6
                      },
                      "ao": {
                        "text": "Angola (AO)",
                        "index": 7
                      },
                      "aq": {
                        "text": "Antarctica (AQ)",
                        "index": 8
                      },
                      "ar": {
                        "text": "Argentina (AR)",
                        "index": 9
                      },
                      "as": {
                        "text": "American Samoa (AS)",
                        "index": 10
                      },
                      "at": {
                        "text": "Austria (AT)",
                        "index": 11
                      },
                      "au": {
                        "text": "Australia (AU)",
                        "index": 12
                      },
                      "aw": {
                        "text": "Aruba (AW)",
                        "index": 13
                      },
                      "ax": {
                        "text": "\u00c5land Islands (AX)",
                        "index": 14
                      },
                      "az": {
                        "text": "Azerbaijan (AZ)",
                        "index": 15
                      },
                      "ba": {
                        "text": "Bosnia and Herzegovina (BA)",
                        "index": 16
                      },
                      "bb": {
                        "text": "Barbados (BB)",
                        "index": 17
                      },
                      "bd": {
                        "text": "Bangladesh (BD)",
                        "index": 18
                      },
                      "be": {
                        "text": "Belgium (BE)",
                        "index": 19
                      },
                      "bf": {
                        "text": "Burkina Faso (BF)",
                        "index": 20
                      },
                      "bg": {
                        "text": "Bulgaria (BG)",
                        "index": 21
                      },
                      "bh": {
                        "text": "Bahrain (BH)",
                        "index": 22
                      },
                      "bi": {
                        "text": "Burundi (BI)",
                        "index": 23
                      },
                      "bj": {
                        "text": "Benin (BJ)",
                        "index": 24
                      },
                      "bl": {
                        "text": "Saint Barth\u00e9lemy (BL)",
                        "index": 25
                      },
                      "bm": {
                        "text": "Bermuda (BM)",
                        "index": 26
                      },
                      "bn": {
                        "text": "Brunei Darussalam (BN)",
                        "index": 27
                      },
                      "bo": {
                        "text": "Bolivia, Plurinational State of (BO)",
                        "index": 28
                      },
                      "bq": {
                        "text": "Bonaire, Sint Eustatius and Saba (BQ)",
                        "index": 29
                      },
                      "br": {
                        "text": "Brazil (BR)",
                        "index": 30
                      },
                      "bs": {
                        "text": "Bahamas (BS)",
                        "index": 31
                      },
                      "bt": {
                        "text": "Bhutan (BT)",
                        "index": 32
                      },
                      "bv": {
                        "text": "Bouvet Island (BV)",
                        "index": 33
                      },
                      "bw": {
                        "text": "Botswana (BW)",
                        "index": 34
                      },
                      "by": {
                        "text": "Belarus (BY)",
                        "index": 35
                      },
                      "bz": {
                        "text": "Belize (BZ)",
                        "index": 36
                      },
                      "ca": {
                        "text": "Canada (CA)",
                        "index": 37
                      },
                      "cc": {
                        "text": "Cocos (Keeling) Islands (CC)",
                        "index": 38
                      },
                      "cd": {
                        "text": "Congo, Democratic Republic of the (CD)",
                        "index": 39
                      },
                      "cf": {
                        "text": "Central African Republic (CF)",
                        "index": 40
                      },
                      "cg": {
                        "text": "Congo (CG)",
                        "index": 41
                      },
                      "ch": {
                        "text": "Switzerland (CH)",
                        "index": 42
                      },
                      "ci": {
                        "text": "C\u00f4te d'Ivoire (CI)",
                        "index": 43
                      },
                      "ck": {
                        "text": "Cook Islands (CK)",
                        "index": 44
                      },
                      "cl": {
                        "text": "Chile (CL)",
                        "index": 45
                      },
                      "cm": {
                        "text": "Cameroon (CM)",
                        "index": 46
                      },
                      "cn": {
                        "text": "China (CN)",
                        "index": 47
                      },
                      "co": {
                        "text": "Colombia (CO)",
                        "index": 48
                      },
                      "cr": {
                        "text": "Costa Rica (CR)",
                        "index": 49
                      },
                      "cu": {
                        "text": "Cuba (CU)",
                        "index": 50
                      },
                      "cv": {
                        "text": "Cabo Verde (CV)",
                        "index": 51
                      },
                      "cw": {
                        "text": "Cura\u00e7ao (CW)",
                        "index": 52
                      },
                      "cx": {
                        "text": "Christmas Island (CX)",
                        "index": 53
                      },
                      "cy": {
                        "text": "Cyprus (CY)",
                        "index": 54
                      },
                      "cz": {
                        "text": "Czechia (CZ)",
                        "index": 55
                      },
                      "de": {
                        "text": "Germany (DE)",
                        "index": 56
                      },
                      "dj": {
                        "text": "Djibouti (DJ)",
                        "index": 57
                      },
                      "dk": {
                        "text": "Denmark (DK)",
                        "index": 58
                      },
                      "dm": {
                        "text": "Dominica (DM)",
                        "index": 59
                      },
                      "do": {
                        "text": "Dominican Republic (DO)",
                        "index": 60
                      },
                      "dz": {
                        "text": "Algeria (DZ)",
                        "index": 61
                      },
                      "ec": {
                        "text": "Ecuador (EC)",
                        "index": 62
                      },
                      "ee": {
                        "text": "Estonia (EE)",
                        "index": 63
                      },
                      "eg": {
                        "text": "Egypt (EG)",
                        "index": 64
                      },
                      "eh": {
                        "text": "Western Sahara (EH)",
                        "index": 65
                      },
                      "er": {
                        "text": "Eritrea (ER)",
                        "index": 66
                      },
                      "es": {
                        "text": "Spain (ES)",
                        "index": 67
                      },
                      "et": {
                        "text": "Ethiopia (ET)",
                        "index": 68
                      },
                      "fi": {
                        "text": "Finland (FI)",
                        "index": 69
                      },
                      "fj": {
                        "text": "Fiji (FJ)",
                        "index": 70
                      },
                      "fk": {
                        "text": "Falkland Islands (Malvinas) (FK)",
                        "index": 71
                      },
                      "fm": {
                        "text": "Micronesia, Federated States of (FM)",
                        "index": 72
                      },
                      "fo": {
                        "text": "Faroe Islands (FO)",
                        "index": 73
                      },
                      "fr": {
                        "text": "France (FR)",
                        "index": 74
                      },
                      "ga": {
                        "text": "Gabon (GA)",
                        "index": 75
                      },
                      "gb": {
                        "text": "United Kingdom of Great Britain and Northern Ireland (GB)",
                        "index": 76
                      },
                      "gd": {
                        "text": "Grenada (GD)",
                        "index": 77
                      },
                      "ge": {
                        "text": "Georgia (GE)",
                        "index": 78
                      },
                      "gf": {
                        "text": "French Guiana (GF)",
                        "index": 79
                      },
                      "gg": {
                        "text": "Guernsey (GG)",
                        "index": 80
                      },
                      "gh": {
                        "text": "Ghana (GH)",
                        "index": 81
                      },
                      "gi": {
                        "text": "Gibraltar (GI)",
                        "index": 82
                      },
                      "gl": {
                        "text": "Greenland (GL)",
                        "index": 83
                      },
                      "gm": {
                        "text": "Gambia (GM)",
                        "index": 84
                      },
                      "gn": {
                        "text": "Guinea (GN)",
                        "index": 85
                      },
                      "gp": {
                        "text": "Guadeloupe (GP)",
                        "index": 86
                      },
                      "gq": {
                        "text": "Equatorial Guinea (GQ)",
                        "index": 87
                      },
                      "gr": {
                        "text": "Greece (GR)",
                        "index": 88
                      },
                      "gs": {
                        "text": "South Georgia and the South Sandwich Islands (GS)",
                        "index": 89
                      },
                      "gt": {
                        "text": "Guatemala (GT)",
                        "index": 90
                      },
                      "gu": {
                        "text": "Guam (GU)",
                        "index": 91
                      },
                      "gw": {
                        "text": "Guinea-Bissau (GW)",
                        "index": 92
                      },
                      "gy": {
                        "text": "Guyana (GY)",
                        "index": 93
                      },
                      "hk": {
                        "text": "Hong Kong (HK)",
                        "index": 94
                      },
                      "hm": {
                        "text": "Heard Island and McDonald Islands (HM)",
                        "index": 95
                      },
                      "hn": {
                        "text": "Honduras (HN)",
                        "index": 96
                      },
                      "hr": {
                        "text": "Croatia (HR)",
                        "index": 97
                      },
                      "ht": {
                        "text": "Haiti (HT)",
                        "index": 98
                      },
                      "hu": {
                        "text": "Hungary (HU)",
                        "index": 99
                      },
                      "id": {
                        "text": "Indonesia (ID)",
                        "index": 100
                      },
                      "ie": {
                        "text": "Ireland (IE)",
                        "index": 101
                      },
                      "il": {
                        "text": "Israel (IL)",
                        "index": 102
                      },
                      "im": {
                        "text": "Isle of Man (IM)",
                        "index": 103
                      },
                      "in": {
                        "text": "India (IN)",
                        "index": 104
                      },
                      "io": {
                        "text": "British Indian Ocean Territory (IO)",
                        "index": 105
                      },
                      "iq": {
                        "text": "Iraq (IQ)",
                        "index": 106
                      },
                      "ir": {
                        "text": "Iran, Islamic Republic of (IR)",
                        "index": 107
                      },
                      "is": {
                        "text": "Iceland (IS)",
                        "index": 108
                      },
                      "it": {
                        "text": "Italy (IT)",
                        "index": 109
                      },
                      "je": {
                        "text": "Jersey (JE)",
                        "index": 110
                      },
                      "jm": {
                        "text": "Jamaica (JM)",
                        "index": 111
                      },
                      "jo": {
                        "text": "Jordan (JO)",
                        "index": 112
                      },
                      "jp": {
                        "text": "Japan (JP)",
                        "index": 113
                      },
                      "ke": {
                        "text": "Kenya (KE)",
                        "index": 114
                      },
                      "kg": {
                        "text": "Kyrgyzstan (KG)",
                        "index": 115
                      },
                      "kh": {
                        "text": "Cambodia (KH)",
                        "index": 116
                      },
                      "ki": {
                        "text": "Kiribati (KI)",
                        "index": 117
                      },
                      "km": {
                        "text": "Comoros (KM)",
                        "index": 118
                      },
                      "kn": {
                        "text": "Saint Kitts and Nevis (KN)",
                        "index": 119
                      },
                      "kp": {
                        "text": "Korea, Democratic People's Republic of (KP)",
                        "index": 120
                      },
                      "kr": {
                        "text": "Korea, Republic of (KR)",
                        "index": 121
                      },
                      "kw": {
                        "text": "Kuwait (KW)",
                        "index": 122
                      },
                      "ky": {
                        "text": "Cayman Islands (KY)",
                        "index": 123
                      },
                      "kz": {
                        "text": "Kazakhstan (KZ)",
                        "index": 124
                      },
                      "la": {
                        "text": "Lao People's Democratic Republic (LA)",
                        "index": 125
                      },
                      "lb": {
                        "text": "Lebanon (LB)",
                        "index": 126
                      },
                      "lc": {
                        "text": "Saint Lucia (LC)",
                        "index": 127
                      },
                      "li": {
                        "text": "Liechtenstein (LI)",
                        "index": 128
                      },
                      "lk": {
                        "text": "Sri Lanka (LK)",
                        "index": 129
                      },
                      "lr": {
                        "text": "Liberia (LR)",
                        "index": 130
                      },
                      "ls": {
                        "text": "Lesotho (LS)",
                        "index": 131
                      },
                      "lt": {
                        "text": "Lithuania (LT)",
                        "index": 132
                      },
                      "lu": {
                        "text": "Luxembourg (LU)",
                        "index": 133
                      },
                      "lv": {
                        "text": "Latvia (LV)",
                        "index": 134
                      },
                      "ly": {
                        "text": "Libya (LY)",
                        "index": 135
                      },
                      "ma": {
                        "text": "Morocco (MA)",
                        "index": 136
                      },
                      "mc": {
                        "text": "Monaco (MC)",
                        "index": 137
                      },
                      "md": {
                        "text": "Moldova, Republic of (MD)",
                        "index": 138
                      },
                      "me": {
                        "text": "Montenegro (ME)",
                        "index": 139
                      },
                      "mf": {
                        "text": "Saint Martin (French part) (MF)",
                        "index": 140
                      },
                      "mg": {
                        "text": "Madagascar (MG)",
                        "index": 141
                      },
                      "mh": {
                        "text": "Marshall Islands (MH)",
                        "index": 142
                      },
                      "mk": {
                        "text": "North Macedonia (MK)",
                        "index": 143
                      },
                      "ml": {
                        "text": "Mali (ML)",
                        "index": 144
                      },
                      "mm": {
                        "text": "Myanmar (MM)",
                        "index": 145
                      },
                      "mn": {
                        "text": "Mongolia (MN)",
                        "index": 146
                      },
                      "mo": {
                        "text": "Macao (MO)",
                        "index": 147
                      },
                      "mp": {
                        "text": "Northern Mariana Islands (MP)",
                        "index": 148
                      },
                      "mq": {
                        "text": "Martinique (MQ)",
                        "index": 149
                      },
                      "mr": {
                        "text": "Mauritania (MR)",
                        "index": 150
                      },
                      "ms": {
                        "text": "Montserrat (MS)",
                        "index": 151
                      },
                      "mt": {
                        "text": "Malta (MT)",
                        "index": 152
                      },
                      "mu": {
                        "text": "Mauritius (MU)",
                        "index": 153
                      },
                      "mv": {
                        "text": "Maldives (MV)",
                        "index": 154
                      },
                      "mw": {
                        "text": "Malawi (MW)",
                        "index": 155
                      },
                      "mx": {
                        "text": "Mexico (MX)",
                        "index": 156
                      },
                      "my": {
                        "text": "Malaysia (MY)",
                        "index": 157
                      },
                      "mz": {
                        "text": "Mozambique (MZ)",
                        "index": 158
                      },
                      "na": {
                        "text": "Namibia (NA)",
                        "index": 159
                      },
                      "nc": {
                        "text": "New Caledonia (NC)",
                        "index": 160
                      },
                      "ne": {
                        "text": "Niger (NE)",
                        "index": 161
                      },
                      "nf": {
                        "text": "Norfolk Island (NF)",
                        "index": 162
                      },
                      "ng": {
                        "text": "Nigeria (NG)",
                        "index": 163
                      },
                      "ni": {
                        "text": "Nicaragua (NI)",
                        "index": 164
                      },
                      "nl": {
                        "text": "Netherlands, Kingdom of the (NL)",
                        "index": 165
                      },
                      "no": {
                        "text": "Norway (NO)",
                        "index": 166
                      },
                      "np": {
                        "text": "Nepal (NP)",
                        "index": 167
                      },
                      "nr": {
                        "text": "Nauru (NR)",
                        "index": 168
                      },
                      "nu": {
                        "text": "Niue (NU)",
                        "index": 169
                      },
                      "nz": {
                        "text": "New Zealand (NZ)",
                        "index": 170
                      },
                      "om": {
                        "text": "Oman (OM)",
                        "index": 171
                      },
                      "pa": {
                        "text": "Panama (PA)",
                        "index": 172
                      },
                      "pe": {
                        "text": "Peru (PE)",
                        "index": 173
                      },
                      "pf": {
                        "text": "French Polynesia (PF)",
                        "index": 174
                      },
                      "pg": {
                        "text": "Papua New Guinea (PG)",
                        "index": 175
                      },
                      "ph": {
                        "text": "Philippines (PH)",
                        "index": 176
                      },
                      "pk": {
                        "text": "Pakistan (PK)",
                        "index": 177
                      },
                      "pl": {
                        "text": "Poland (PL)",
                        "index": 178
                      },
                      "pm": {
                        "text": "Saint Pierre and Miquelon (PM)",
                        "index": 179
                      },
                      "pn": {
                        "text": "Pitcairn (PN)",
                        "index": 180
                      },
                      "pr": {
                        "text": "Puerto Rico (PR)",
                        "index": 181
                      },
                      "ps": {
                        "text": "Palestine, State of (PS)",
                        "index": 182
                      },
                      "pt": {
                        "text": "Portugal (PT)",
                        "index": 183
                      },
                      "pw": {
                        "text": "Palau (PW)",
                        "index": 184
                      },
                      "py": {
                        "text": "Paraguay (PY)",
                        "index": 185
                      },
                      "qa": {
                        "text": "Qatar (QA)",
                        "index": 186
                      },
                      "re": {
                        "text": "R\u00e9union (RE)",
                        "index": 187
                      },
                      "ro": {
                        "text": "Romania (RO)",
                        "index": 188
                      },
                      "rs": {
                        "text": "Serbia (RS)",
                        "index": 189
                      },
                      "ru": {
                        "text": "Russian Federation (RU)",
                        "index": 190
                      },
                      "rw": {
                        "text": "Rwanda (RW)",
                        "index": 191
                      },
                      "sa": {
                        "text": "Saudi Arabia (SA)",
                        "index": 192
                      },
                      "sb": {
                        "text": "Solomon Islands (SB)",
                        "index": 193
                      },
                      "sc": {
                        "text": "Seychelles (SC)",
                        "index": 194
                      },
                      "sd": {
                        "text": "Sudan (SD)",
                        "index": 195
                      },
                      "se": {
                        "text": "Sweden (SE)",
                        "index": 196
                      },
                      "sg": {
                        "text": "Singapore (SG)",
                        "index": 197
                      },
                      "sh": {
                        "text": "Saint Helena, Ascension and Tristan da Cunha (SH)",
                        "index": 198
                      },
                      "si": {
                        "text": "Slovenia (SI)",
                        "index": 199
                      },
                      "sj": {
                        "text": "Svalbard and Jan Mayen (SJ)",
                        "index": 200
                      },
                      "sk": {
                        "text": "Slovakia (SK)",
                        "index": 201
                      },
                      "sl": {
                        "text": "Sierra Leone (SL)",
                        "index": 202
                      },
                      "sm": {
                        "text": "San Marino (SM)",
                        "index": 203
                      },
                      "sn": {
                        "text": "Senegal (SN)",
                        "index": 204
                      },
                      "so": {
                        "text": "Somalia (SO)",
                        "index": 205
                      },
                      "sr": {
                        "text": "Suriname (SR)",
                        "index": 206
                      },
                      "ss": {
                        "text": "South Sudan (SS)",
                        "index": 207
                      },
                      "st": {
                        "text": "Sao Tome and Principe (ST)",
                        "index": 208
                      },
                      "sv": {
                        "text": "El Salvador (SV)",
                        "index": 209
                      },
                      "sx": {
                        "text": "Sint Maarten (Dutch part) (SX)",
                        "index": 210
                      },
                      "sy": {
                        "text": "Syrian Arab Republic (SY)",
                        "index": 211
                      },
                      "sz": {
                        "text": "Eswatini (SZ)",
                        "index": 212
                      },
                      "tc": {
                        "text": "Turks and Caicos Islands (TC)",
                        "index": 213
                      },
                      "td": {
                        "text": "Chad (TD)",
                        "index": 214
                      },
                      "tf": {
                        "text": "French Southern Territories (TF)",
                        "index": 215
                      },
                      "tg": {
                        "text": "Togo (TG)",
                        "index": 216
                      },
                      "th": {
                        "text": "Thailand (TH)",
                        "index": 217
                      },
                      "tj": {
                        "text": "Tajikistan (TJ)",
                        "index": 218
                      },
                      "tk": {
                        "text": "Tokelau (TK)",
                        "index": 219
                      },
                      "tl": {
                        "text": "Timor-Leste (TL)",
                        "index": 220
                      },
                      "tm": {
                        "text": "Turkmenistan (TM)",
                        "index": 221
                      },
                      "tn": {
                        "text": "Tunisia (TN)",
                        "index": 222
                      },
                      "to": {
                        "text": "Tonga (TO)",
                        "index": 223
                      },
                      "tr": {
                        "text": "T\u00fcrkiye (TR)",
                        "index": 224
                      },
                      "tt": {
                        "text": "Trinidad and Tobago (TT)",
                        "index": 225
                      },
                      "tv": {
                        "text": "Tuvalu (TV)",
                        "index": 226
                      },
                      "tw": {
                        "text": "Taiwan, Province of China (TW)",
                        "index": 227
                      },
                      "tz": {
                        "text": "Tanzania, United Republic of (TZ)",
                        "index": 228
                      },
                      "ua": {
                        "text": "Ukraine (UA)",
                        "index": 229
                      },
                      "ug": {
                        "text": "Uganda (UG)",
                        "index": 230
                      },
                      "um": {
                        "text": "United States Minor Outlying Islands (UM)",
                        "index": 231
                      },
                      "us": {
                        "text": "United States of America (US)",
                        "index": 232
                      },
                      "uy": {
                        "text": "Uruguay (UY)",
                        "index": 233
                      },
                      "uz": {
                        "text": "Uzbekistan (UZ)",
                        "index": 234
                      },
                      "va": {
                        "text": "Holy See (VA)",
                        "index": 235
                      },
                      "vc": {
                        "text": "Saint Vincent and the Grenadines (VC)",
                        "index": 236
                      },
                      "ve": {
                        "text": "Venezuela, Bolivarian Republic of (VE)",
                        "index": 237
                      },
                      "vg": {
                        "text": "Virgin Islands (British) (VG)",
                        "index": 238
                      },
                      "vi": {
                        "text": "Virgin Islands (U.S.) (VI)",
                        "index": 239
                      },
                      "vn": {
                        "text": "Viet Nam (VN)",
                        "index": 240
                      },
                      "vu": {
                        "text": "Vanuatu (VU)",
                        "index": 241
                      },
                      "wf": {
                        "text": "Wallis and Futuna (WF)",
                        "index": 242
                      },
                      "ws": {
                        "text": "Samoa (WS)",
                        "index": 243
                      },
                      "ye": {
                        "text": "Yemen (YE)",
                        "index": 244
                      },
                      "yt": {
                        "text": "Mayotte (YT)",
                        "index": 245
                      },
                      "za": {
                        "text": "South Africa (ZA)",
                        "index": 246
                      },
                      "zm": {
                        "text": "Zambia (ZM)",
                        "index": 247
                      },
                      "zw": {
                        "text": "Zimbabwe (ZW)",
                        "index": 248
                      }
                    }
                  }
                ]
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 24,
        "x": 0,
        "y": 235
      },
      "id": 77,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Geo Anomaly: Sensitive Paths by Country",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(20, sum by (ClientCountry, ClientRequestPath) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | ClientRequestPath =~ `.*(admin|login|wp-login|phpmyadmin|xmlrpc|eval|exec|api/auth).*` [$__range])))",
          "legendFormat": "{{ClientCountry}} {{ClientRequestPath}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Access to sensitive paths (admin, login, wp-login, phpmyadmin, etc.) grouped by country. Unexpected countries accessing admin paths may indicate reconnaissance. MITRE ATT&CK T1595."
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 243
      },
      "id": 78,
      "panels": [],
      "title": "Bot Analysis",
      "type": "row"
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Likely Bot (1-29)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Possibly Bot (30-49)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Likely Human (50+)"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 244
      },
      "id": 79,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Bot Score Distribution",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json BotScore, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | BotScore > 0 | BotScore < 30 [$__auto]))",
          "legendFormat": "Likely Bot (1-29)",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json BotScore, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | BotScore >= 30 | BotScore < 50 [$__auto]))",
          "legendFormat": "Possibly Bot (30-49)",
          "refId": "B",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json BotScore, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | BotScore >= 50 [$__auto]))",
          "legendFormat": "Likely Human (50+)",
          "refId": "C",
          "queryType": "range"
        }
      ],
      "description": "Cloudflare Bot Management score distribution. 1-29 = likely automated, 30-49 = ambiguous, 50-99 = likely human. Score 0 = not computed."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 244
      },
      "id": 80,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Bot Score Source Engine",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (BotScoreSrc) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json BotScoreSrc, ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | BotScoreSrc != `` | BotScoreSrc != `Not Computed` [$__auto]))",
          "legendFormat": "{{BotScoreSrc}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Which detection engine computed the bot score: Machine Learning, Heuristics, JS Fingerprinting, or Behavioral Analysis."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 252
      },
      "id": 81,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Verified Bot Categories",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (VerifiedBotCategory) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, VerifiedBotCategory, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | VerifiedBotCategory != `` [$__auto]))",
          "legendFormat": "{{VerifiedBotCategory}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Known legitimate bots verified by Cloudflare (Googlebot, Bingbot, etc.) grouped by category."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "passed"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "failed"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "missing"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 252
      },
      "id": 82,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "JS Detection Pass/Fail",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (JSDetectionPassed) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, JSDetectionPassed, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | JSDetectionPassed != `` [$__auto]))",
          "legendFormat": "{{JSDetectionPassed}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "JavaScript fingerprinting challenge results. 'failed' = client did not execute JS (likely headless bot). 'missing' = challenge not served."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 260
      },
      "id": 83,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top JA4 TLS Fingerprints",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(25, sum by (JA4) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | JA4 != `` [$__range])))",
          "legendFormat": "{{JA4}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Top JA4 TLS fingerprints. JA4 identifies TLS client implementations (browsers, bots, libraries). Same fingerprint = same TLS stack."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Value #A"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 100
              },
              {
                "id": "displayName",
                "value": "Count"
              },
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "basic",
                  "type": "gauge",
                  "valueDisplayMode": "text"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Time"
            },
            "properties": [
              {
                "id": "custom.hidden",
                "value": true
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 260
      },
      "id": 84,
      "options": {
        "showHeader": true,
        "cellHeight": "sm",
        "footer": {
          "show": false
        },
        "sortBy": [
          {
            "desc": true,
            "displayName": "Count"
          }
        ]
      },
      "title": "Top JA3 Hashes",
      "type": "table",
      "transformations": [
        {
          "id": "sortBy",
          "options": {
            "sort": [
              {
                "field": "Value #A",
                "desc": true
              }
            ]
          }
        }
      ],
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "approx_topk(25, sum by (JA3Hash) (count_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA3Hash, JA4, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | JA3Hash != `` [$__range])))",
          "legendFormat": "{{JA3Hash}}",
          "refId": "A",
          "instant": true,
          "format": "table"
        }
      ],
      "description": "Top JA3 TLS fingerprint hashes. Legacy fingerprinting method (predecessor to JA4). Useful for identifying known malicious TLS implementations."
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 268
      },
      "id": 85,
      "panels": [],
      "title": "Workers",
      "type": "row"
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "ok"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "exception"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "exceeded_cpu"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "orange",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "exceeded_memory"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "canceled"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "semi-dark-blue",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 269
      },
      "id": 86,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Worker Outcomes",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (Outcome) (count_over_time({job=\"cloudflare-logpush\", dataset=\"workers_trace_events\"} | json Outcome [$__auto]))",
          "legendFormat": "{{Outcome}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Worker execution outcomes. 'exception' = unhandled error, 'exceeded_cpu' = hit CPU time limit, 'exceeded_memory' = hit memory limit."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 8,
        "y": 269
      },
      "id": 87,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Worker CPU Time (ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "avg by (ScriptName) (avg_over_time({job=\"cloudflare-logpush\", dataset=\"workers_trace_events\"} | json CPUTimeMs, ScriptName | unwrap CPUTimeMs [$__auto]))",
          "legendFormat": "Avg {{ScriptName}}",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.95, {job=\"cloudflare-logpush\", dataset=\"workers_trace_events\"} | json CPUTimeMs | unwrap CPUTimeMs [$__auto]))",
          "legendFormat": "p95",
          "refId": "B",
          "queryType": "range"
        }
      ],
      "description": "CPU time consumed per Worker invocation. Workers have a 10ms (free) or 50ms (paid) CPU time limit. Approaching the limit risks 'exceeded_cpu' outcomes."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 269
      },
      "id": 88,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "lastNotNull"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Worker Wall Time (ms)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "avg by (ScriptName) (avg_over_time({job=\"cloudflare-logpush\", dataset=\"workers_trace_events\"} | json ScriptName, WallTimeMs | unwrap WallTimeMs [$__auto]))",
          "legendFormat": "Avg {{ScriptName}}",
          "refId": "A",
          "queryType": "range"
        },
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum(quantile_over_time(0.95, {job=\"cloudflare-logpush\", dataset=\"workers_trace_events\"} | json WallTimeMs | unwrap WallTimeMs [$__auto]))",
          "legendFormat": "p95",
          "refId": "B",
          "queryType": "range"
        }
      ],
      "description": "Total wall-clock time per Worker invocation (includes I/O wait). Wall time limit is 30s (default). Unlike CPU time, I/O wait does not count toward CPU limits."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "bars",
            "fillOpacity": 80,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 277
      },
      "id": 89,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Worker Invocations by Script",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ScriptName) (count_over_time({job=\"cloudflare-logpush\", dataset=\"workers_trace_events\"} | json ScriptName [$__auto]))",
          "legendFormat": "{{ScriptName}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Number of Worker invocations per script over time."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 12,
        "y": 277
      },
      "id": 90,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Worker Script Versions",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "sum by (ScriptName, ScriptVersion) (count_over_time({job=\"cloudflare-logpush\", dataset=\"workers_trace_events\"} | json ScriptName, ScriptVersion | ScriptVersion != `` [$__auto]))",
          "legendFormat": "{{ScriptName}} v{{ScriptVersion}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Worker script version tracking. Useful during deployments to confirm new versions are receiving traffic."
    },
    {
      "datasource": {
        "type": "loki",
        "uid": "${DS_LOKI}"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "linear",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 6,
        "x": 18,
        "y": 277
      },
      "id": 91,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom"
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "title": "Worker Subrequest Count (avg)",
      "type": "timeseries",
      "targets": [
        {
          "datasource": {
            "type": "loki",
            "uid": "${DS_LOKI}"
          },
          "expr": "avg by (WorkerScriptName) (avg_over_time({job=\"cloudflare-logpush\", dataset=\"http_requests\"} | json ClientASN, ClientCountry, ClientIP, ClientRequestHost, ClientRequestPath, EdgeColoCode, JA4, WorkerScriptName, WorkerSubrequestCount, ZoneName | ZoneName =~ \"$zone\" | ClientRequestHost =~ \"$host\" | ClientCountry =~ \"$country\" | ClientRequestPath =~ \"$path\" | ClientIP =~ \"$ip\" | JA4 =~ \"$ja4\" | ClientASN =~ \"$asn\" | EdgeColoCode =~ \"$colo\" | unwrap WorkerSubrequestCount [$__auto]))",
          "legendFormat": "{{WorkerScriptName}}",
          "refId": "A",
          "queryType": "range"
        }
      ],
      "description": "Average number of subrequests (fetch calls) per Worker invocation. Workers have a 50 subrequest limit per invocation."
    }
  ],
  "schemaVersion": 39,
  "tags": [
    "cloudflare",
    "logpush",
    "loki",
    "security"
  ],
  "templating": {
    "list": [
      {
        "allValue": ".*",
        "current": {
          "selected": true,
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "description": "Filter by Cloudflare zone name (domain). Filters HTTP requests by ZoneName field, and firewall events by ClientRequestHost (regex match). Use to isolate traffic for a specific zone.",
        "hide": 0,
        "includeAll": true,
        "label": "Zone",
        "multi": true,
        "name": "zone",
        "options": [
          {
            "selected": true,
            "text": "All",
            "value": "$__all"
          }
        ],
        "query": "",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "allValue": ".*",
        "current": {
          "selected": true,
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "description": "Filter by hostname (FQDN). More specific than zone \u2014 use for subdomains like blog.example.com within a zone.",
        "hide": 0,
        "includeAll": true,
        "label": "Host",
        "multi": true,
        "name": "host",
        "options": [
          {
            "selected": true,
            "text": "All",
            "value": "$__all"
          }
        ],
        "query": "",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {
          "selected": false,
          "text": ".*",
          "value": ".*"
        },
        "description": "Filter by request path (regex, e.g. /api/.* or /login). Use .* for all.",
        "hide": 0,
        "label": "Path",
        "name": "path",
        "query": ".*",
        "skipUrlSync": false,
        "type": "textbox"
      },
      {
        "current": {
          "selected": false,
          "text": ".*",
          "value": ".*"
        },
        "description": "Filter by client IP (regex, e.g. 192\\.168\\.1\\..* for prefix or exact IP). Use .* for all.",
        "hide": 0,
        "label": "IP",
        "name": "ip",
        "query": ".*",
        "skipUrlSync": false,
        "type": "textbox"
      },
      {
        "allValue": ".*",
        "current": {
          "selected": true,
          "text": [
            "All"
          ],
          "value": [
            "$__all"
          ]
        },
        "description": "Filter by client country (multi-select). Matches on ISO 3166-1 Alpha-2 code.",
        "hide": 0,
        "includeAll": true,
        "label": "Country",
        "multi": true,
        "name": "country",
        "options": [
          {
            "selected": true,
            "text": "All",
            "value": "$__all"
          },
          {
            "selected": false,
            "text": "Afghanistan (AF)",
            "value": "af"
          },
          {
            "selected": false,
            "text": "Albania (AL)",
            "value": "al"
          },
          {
            "selected": false,
            "text": "Algeria (DZ)",
            "value": "dz"
          },
          {
            "selected": false,
            "text": "American Samoa (AS)",
            "value": "as"
          },
          {
            "selected": false,
            "text": "Andorra (AD)",
            "value": "ad"
          },
          {
            "selected": false,
            "text": "Angola (AO)",
            "value": "ao"
          },
          {
            "selected": false,
            "text": "Anguilla (AI)",
            "value": "ai"
          },
          {
            "selected": false,
            "text": "Antarctica (AQ)",
            "value": "aq"
          },
          {
            "selected": false,
            "text": "Antigua and Barbuda (AG)",
            "value": "ag"
          },
          {
            "selected": false,
            "text": "Argentina (AR)",
            "value": "ar"
          },
          {
            "selected": false,
            "text": "Armenia (AM)",
            "value": "am"
          },
          {
            "selected": false,
            "text": "Aruba (AW)",
            "value": "aw"
          },
          {
            "selected": false,
            "text": "Australia (AU)",
            "value": "au"
          },
          {
            "selected": false,
            "text": "Austria (AT)",
            "value": "at"
          },
          {
            "selected": false,
            "text": "Azerbaijan (AZ)",
            "value": "az"
          },
          {
            "selected": false,
            "text": "Bahamas (BS)",
            "value": "bs"
          },
          {
            "selected": false,
            "text": "Bahrain (BH)",
            "value": "bh"
          },
          {
            "selected": false,
            "text": "Bangladesh (BD)",
            "value": "bd"
          },
          {
            "selected": false,
            "text": "Barbados (BB)",
            "value": "bb"
          },
          {
            "selected": false,
            "text": "Belarus (BY)",
            "value": "by"
          },
          {
            "selected": false,
            "text": "Belgium (BE)",
            "value": "be"
          },
          {
            "selected": false,
            "text": "Belize (BZ)",
            "value": "bz"
          },
          {
            "selected": false,
            "text": "Benin (BJ)",
            "value": "bj"
          },
          {
            "selected": false,
            "text": "Bermuda (BM)",
            "value": "bm"
          },
          {
            "selected": false,
            "text": "Bhutan (BT)",
            "value": "bt"
          },
          {
            "selected": false,
            "text": "Bolivia, Plurinational State of (BO)",
            "value": "bo"
          },
          {
            "selected": false,
            "text": "Bonaire, Sint Eustatius and Saba (BQ)",
            "value": "bq"
          },
          {
            "selected": false,
            "text": "Bosnia and Herzegovina (BA)",
            "value": "ba"
          },
          {
            "selected": false,
            "text": "Botswana (BW)",
            "value": "bw"
          },
          {
            "selected": false,
            "text": "Bouvet Island (BV)",
            "value": "bv"
          },
          {
            "selected": false,
            "text": "Brazil (BR)",
            "value": "br"
          },
          {
            "selected": false,
            "text": "British Indian Ocean Territory (IO)",
            "value": "io"
          },
          {
            "selected": false,
            "text": "Brunei Darussalam (BN)",
            "value": "bn"
          },
          {
            "selected": false,
            "text": "Bulgaria (BG)",
            "value": "bg"
          },
          {
            "selected": false,
            "text": "Burkina Faso (BF)",
            "value": "bf"
          },
          {
            "selected": false,
            "text": "Burundi (BI)",
            "value": "bi"
          },
          {
            "selected": false,
            "text": "Cabo Verde (CV)",
            "value": "cv"
          },
          {
            "selected": false,
            "text": "Cambodia (KH)",
            "value": "kh"
          },
          {
            "selected": false,
            "text": "Cameroon (CM)",
            "value": "cm"
          },
          {
            "selected": false,
            "text": "Canada (CA)",
            "value": "ca"
          },
          {
            "selected": false,
            "text": "Cayman Islands (KY)",
            "value": "ky"
          },
          {
            "selected": false,
            "text": "Central African Republic (CF)",
            "value": "cf"
          },
          {
            "selected": false,
            "text": "Chad (TD)",
            "value": "td"
          },
          {
            "selected": false,
            "text": "Chile (CL)",
            "value": "cl"
          },
          {
            "selected": false,
            "text": "China (CN)",
            "value": "cn"
          },
          {
            "selected": false,
            "text": "Christmas Island (CX)",
            "value": "cx"
          },
          {
            "selected": false,
            "text": "Cocos (Keeling) Islands (CC)",
            "value": "cc"
          },
          {
            "selected": false,
            "text": "Colombia (CO)",
            "value": "co"
          },
          {
            "selected": false,
            "text": "Comoros (KM)",
            "value": "km"
          },
          {
            "selected": false,
            "text": "Congo (CG)",
            "value": "cg"
          },
          {
            "selected": false,
            "text": "Congo, Democratic Republic of the (CD)",
            "value": "cd"
          },
          {
            "selected": false,
            "text": "Cook Islands (CK)",
            "value": "ck"
          },
          {
            "selected": false,
            "text": "Costa Rica (CR)",
            "value": "cr"
          },
          {
            "selected": false,
            "text": "Croatia (HR)",
            "value": "hr"
          },
          {
            "selected": false,
            "text": "Cuba (CU)",
            "value": "cu"
          },
          {
            "selected": false,
            "text": "Cura\u00e7ao (CW)",
            "value": "cw"
          },
          {
            "selected": false,
            "text": "Cyprus (CY)",
            "value": "cy"
          },
          {
            "selected": false,
            "text": "Czechia (CZ)",
            "value": "cz"
          },
          {
            "selected": false,
            "text": "C\u00f4te d'Ivoire (CI)",
            "value": "ci"
          },
          {
            "selected": false,
            "text": "Denmark (DK)",
            "value": "dk"
          },
          {
            "selected": false,
            "text": "Djibouti (DJ)",
            "value": "dj"
          },
          {
            "selected": false,
            "text": "Dominica (DM)",
            "value": "dm"
          },
          {
            "selected": false,
            "text": "Dominican Republic (DO)",
            "value": "do"
          },
          {
            "selected": false,
            "text": "Ecuador (EC)",
            "value": "ec"
          },
          {
            "selected": false,
            "text": "Egypt (EG)",
            "value": "eg"
          },
          {
            "selected": false,
            "text": "El Salvador (SV)",
            "value": "sv"
          },
          {
            "selected": false,
            "text": "Equatorial Guinea (GQ)",
            "value": "gq"
          },
          {
            "selected": false,
            "text": "Eritrea (ER)",
            "value": "er"
          },
          {
            "selected": false,
            "text": "Estonia (EE)",
            "value": "ee"
          },
          {
            "selected": false,
            "text": "Eswatini (SZ)",
            "value": "sz"
          },
          {
            "selected": false,
            "text": "Ethiopia (ET)",
            "value": "et"
          },
          {
            "selected": false,
            "text": "Falkland Islands (Malvinas) (FK)",
            "value": "fk"
          },
          {
            "selected": false,
            "text": "Faroe Islands (FO)",
            "value": "fo"
          },
          {
            "selected": false,
            "text": "Fiji (FJ)",
            "value": "fj"
          },
          {
            "selected": false,
            "text": "Finland (FI)",
            "value": "fi"
          },
          {
            "selected": false,
            "text": "France (FR)",
            "value": "fr"
          },
          {
            "selected": false,
            "text": "French Guiana (GF)",
            "value": "gf"
          },
          {
            "selected": false,
            "text": "French Polynesia (PF)",
            "value": "pf"
          },
          {
            "selected": false,
            "text": "French Southern Territories (TF)",
            "value": "tf"
          },
          {
            "selected": false,
            "text": "Gabon (GA)",
            "value": "ga"
          },
          {
            "selected": false,
            "text": "Gambia (GM)",
            "value": "gm"
          },
          {
            "selected": false,
            "text": "Georgia (GE)",
            "value": "ge"
          },
          {
            "selected": false,
            "text": "Germany (DE)",
            "value": "de"
          },
          {
            "selected": false,
            "text": "Ghana (GH)",
            "value": "gh"
          },
          {
            "selected": false,
            "text": "Gibraltar (GI)",
            "value": "gi"
          },
          {
            "selected": false,
            "text": "Greece (GR)",
            "value": "gr"
          },
          {
            "selected": false,
            "text": "Greenland (GL)",
            "value": "gl"
          },
          {
            "selected": false,
            "text": "Grenada (GD)",
            "value": "gd"
          },
          {
            "selected": false,
            "text": "Guadeloupe (GP)",
            "value": "gp"
          },
          {
            "selected": false,
            "text": "Guam (GU)",
            "value": "gu"
          },
          {
            "selected": false,
            "text": "Guatemala (GT)",
            "value": "gt"
          },
          {
            "selected": false,
            "text": "Guernsey (GG)",
            "value": "gg"
          },
          {
            "selected": false,
            "text": "Guinea (GN)",
            "value": "gn"
          },
          {
            "selected": false,
            "text": "Guinea-Bissau (GW)",
            "value": "gw"
          },
          {
            "selected": false,
            "text": "Guyana (GY)",
            "value": "gy"
          },
          {
            "selected": false,
            "text": "Haiti (HT)",
            "value": "ht"
          },
          {
            "selected": false,
            "text": "Heard Island and McDonald Islands (HM)",
            "value": "hm"
          },
          {
            "selected": false,
            "text": "Holy See (VA)",
            "value": "va"
          },
          {
            "selected": false,
            "text": "Honduras (HN)",
            "value": "hn"
          },
          {
            "selected": false,
            "text": "Hong Kong (HK)",
            "value": "hk"
          },
          {
            "selected": false,
            "text": "Hungary (HU)",
            "value": "hu"
          },
          {
            "selected": false,
            "text": "Iceland (IS)",
            "value": "is"
          },
          {
            "selected": false,
            "text": "India (IN)",
            "value": "in"
          },
          {
            "selected": false,
            "text": "Indonesia (ID)",
            "value": "id"
          },
          {
            "selected": false,
            "text": "Iran, Islamic Republic of (IR)",
            "value": "ir"
          },
          {
            "selected": false,
            "text": "Iraq (IQ)",
            "value": "iq"
          },
          {
            "selected": false,
            "text": "Ireland (IE)",
            "value": "ie"
          },
          {
            "selected": false,
            "text": "Isle of Man (IM)",
            "value": "im"
          },
          {
            "selected": false,
            "text": "Israel (IL)",
            "value": "il"
          },
          {
            "selected": false,
            "text": "Italy (IT)",
            "value": "it"
          },
          {
            "selected": false,
            "text": "Jamaica (JM)",
            "value": "jm"
          },
          {
            "selected": false,
            "text": "Japan (JP)",
            "value": "jp"
          },
          {
            "selected": false,
            "text": "Jersey (JE)",
            "value": "je"
          },
          {
            "selected": false,
            "text": "Jordan (JO)",
            "value": "jo"
          },
          {
            "selected": false,
            "text": "Kazakhstan (KZ)",
            "value": "kz"
          },
          {
            "selected": false,
            "text": "Kenya (KE)",
            "value": "ke"
          },
          {
            "selected": false,
            "text": "Kiribati (KI)",
            "value": "ki"
          },
          {
            "selected": false,
            "text": "Korea, Democratic People's Republic of (KP)",
            "value": "kp"
          },
          {
            "selected": false,
            "text": "Korea, Republic of (KR)",
            "value": "kr"
          },
          {
            "selected": false,
            "text": "Kuwait (KW)",
            "value": "kw"
          },
          {
            "selected": false,
            "text": "Kyrgyzstan (KG)",
            "value": "kg"
          },
          {
            "selected": false,
            "text": "Lao People's Democratic Republic (LA)",
            "value": "la"
          },
          {
            "selected": false,
            "text": "Latvia (LV)",
            "value": "lv"
          },
          {
            "selected": false,
            "text": "Lebanon (LB)",
            "value": "lb"
          },
          {
            "selected": false,
            "text": "Lesotho (LS)",
            "value": "ls"
          },
          {
            "selected": false,
            "text": "Liberia (LR)",
            "value": "lr"
          },
          {
            "selected": false,
            "text": "Libya (LY)",
            "value": "ly"
          },
          {
            "selected": false,
            "text": "Liechtenstein (LI)",
            "value": "li"
          },
          {
            "selected": false,
            "text": "Lithuania (LT)",
            "value": "lt"
          },
          {
            "selected": false,
            "text": "Luxembourg (LU)",
            "value": "lu"
          },
          {
            "selected": false,
            "text": "Macao (MO)",
            "value": "mo"
          },
          {
            "selected": false,
            "text": "Madagascar (MG)",
            "value": "mg"
          },
          {
            "selected": false,
            "text": "Malawi (MW)",
            "value": "mw"
          },
          {
            "selected": false,
            "text": "Malaysia (MY)",
            "value": "my"
          },
          {
            "selected": false,
            "text": "Maldives (MV)",
            "value": "mv"
          },
          {
            "selected": false,
            "text": "Mali (ML)",
            "value": "ml"
          },
          {
            "selected": false,
            "text": "Malta (MT)",
            "value": "mt"
          },
          {
            "selected": false,
            "text": "Marshall Islands (MH)",
            "value": "mh"
          },
          {
            "selected": false,
            "text": "Martinique (MQ)",
            "value": "mq"
          },
          {
            "selected": false,
            "text": "Mauritania (MR)",
            "value": "mr"
          },
          {
            "selected": false,
            "text": "Mauritius (MU)",
            "value": "mu"
          },
          {
            "selected": false,
            "text": "Mayotte (YT)",
            "value": "yt"
          },
          {
            "selected": false,
            "text": "Mexico (MX)",
            "value": "mx"
          },
          {
            "selected": false,
            "text": "Micronesia, Federated States of (FM)",
            "value": "fm"
          },
          {
            "selected": false,
            "text": "Moldova, Republic of (MD)",
            "value": "md"
          },
          {
            "selected": false,
            "text": "Monaco (MC)",
            "value": "mc"
          },
          {
            "selected": false,
            "text": "Mongolia (MN)",
            "value": "mn"
          },
          {
            "selected": false,
            "text": "Montenegro (ME)",
            "value": "me"
          },
          {
            "selected": false,
            "text": "Montserrat (MS)",
            "value": "ms"
          },
          {
            "selected": false,
            "text": "Morocco (MA)",
            "value": "ma"
          },
          {
            "selected": false,
            "text": "Mozambique (MZ)",
            "value": "mz"
          },
          {
            "selected": false,
            "text": "Myanmar (MM)",
            "value": "mm"
          },
          {
            "selected": false,
            "text": "Namibia (NA)",
            "value": "na"
          },
          {
            "selected": false,
            "text": "Nauru (NR)",
            "value": "nr"
          },
          {
            "selected": false,
            "text": "Nepal (NP)",
            "value": "np"
          },
          {
            "selected": false,
            "text": "Netherlands, Kingdom of the (NL)",
            "value": "nl"
          },
          {
            "selected": false,
            "text": "New Caledonia (NC)",
            "value": "nc"
          },
          {
            "selected": false,
            "text": "New Zealand (NZ)",
            "value": "nz"
          },
          {
            "selected": false,
            "text": "Nicaragua (NI)",
            "value": "ni"
          },
          {
            "selected": false,
            "text": "Niger (NE)",
            "value": "ne"
          },
          {
            "selected": false,
            "text": "Nigeria (NG)",
            "value": "ng"
          },
          {
            "selected": false,
            "text": "Niue (NU)",
            "value": "nu"
          },
          {
            "selected": false,
            "text": "Norfolk Island (NF)",
            "value": "nf"
          },
          {
            "selected": false,
            "text": "North Macedonia (MK)",
            "value": "mk"
          },
          {
            "selected": false,
            "text": "Northern Mariana Islands (MP)",
            "value": "mp"
          },
          {
            "selected": false,
            "text": "Norway (NO)",
            "value": "no"
          },
          {
            "selected": false,
            "text": "Oman (OM)",
            "value": "om"
          },
          {
            "selected": false,
            "text": "Pakistan (PK)",
            "value": "pk"
          },
          {
            "selected": false,
            "text": "Palau (PW)",
            "value": "pw"
          },
          {
            "selected": false,
            "text": "Palestine, State of (PS)",
            "value": "ps"
          },
          {
            "selected": false,
            "text": "Panama (PA)",
            "value": "pa"
          },
          {
            "selected": false,
            "text": "Papua New Guinea (PG)",
            "value": "pg"
          },
          {
            "selected": false,
            "text": "Paraguay (PY)",
            "value": "py"
          },
          {
            "selected": false,
            "text": "Peru (PE)",
            "value": "pe"
          },
          {
            "selected": false,
            "text": "Philippines (PH)",
            "value": "ph"
          },
          {
            "selected": false,
            "text": "Pitcairn (PN)",
            "value": "pn"
          },
          {
            "selected": false,
            "text": "Poland (PL)",
            "value": "pl"
          },
          {
            "selected": false,
            "text": "Portugal (PT)",
            "value": "pt"
          },
          {
            "selected": false,
            "text": "Puerto Rico (PR)",
            "value": "pr"
          },
          {
            "selected": false,
            "text": "Qatar (QA)",
            "value": "qa"
          },
          {
            "selected": false,
            "text": "Romania (RO)",
            "value": "ro"
          },
          {
            "selected": false,
            "text": "Russian Federation (RU)",
            "value": "ru"
          },
          {
            "selected": false,
            "text": "Rwanda (RW)",
            "value": "rw"
          },
          {
            "selected": false,
            "text": "R\u00e9union (RE)",
            "value": "re"
          },
          {
            "selected": false,
            "text": "Saint Barth\u00e9lemy (BL)",
            "value": "bl"
          },
          {
            "selected": false,
            "text": "Saint Helena, Ascension and Tristan da Cunha (SH)",
            "value": "sh"
          },
          {
            "selected": false,
            "text": "Saint Kitts and Nevis (KN)",
            "value": "kn"
          },
          {
            "selected": false,
            "text": "Saint Lucia (LC)",
            "value": "lc"
          },
          {
            "selected": false,
            "text": "Saint Martin (French part) (MF)",
            "value": "mf"
          },
          {
            "selected": false,
            "text": "Saint Pierre and Miquelon (PM)",
            "value": "pm"
          },
          {
            "selected": false,
            "text": "Saint Vincent and the Grenadines (VC)",
            "value": "vc"
          },
          {
            "selected": false,
            "text": "Samoa (WS)",
            "value": "ws"
          },
          {
            "selected": false,
            "text": "San Marino (SM)",
            "value": "sm"
          },
          {
            "selected": false,
            "text": "Sao Tome and Principe (ST)",
            "value": "st"
          },
          {
            "selected": false,
            "text": "Saudi Arabia (SA)",
            "value": "sa"
          },
          {
            "selected": false,
            "text": "Senegal (SN)",
            "value": "sn"
          },
          {
            "selected": false,
            "text": "Serbia (RS)",
            "value": "rs"
          },
          {
            "selected": false,
            "text": "Seychelles (SC)",
            "value": "sc"
          },
          {
            "selected": false,
            "text": "Sierra Leone (SL)",
            "value": "sl"
          },
          {
            "selected": false,
            "text": "Singapore (SG)",
            "value": "sg"
          },
          {
            "selected": false,
            "text": "Sint Maarten (Dutch part) (SX)",
            "value": "sx"
          },
          {
            "selected": false,
            "text": "Slovakia (SK)",
            "value": "sk"
          },
          {
            "selected": false,
            "text": "Slovenia (SI)",
            "value": "si"
          },
          {
            "selected": false,
            "text": "Solomon Islands (SB)",
            "value": "sb"
          },
          {
            "selected": false,
            "text": "Somalia (SO)",
            "value": "so"
          },
          {
            "selected": false,
            "text": "South Africa (ZA)",
            "value": "za"
          },
          {
            "selected": false,
            "text": "South Georgia and the South Sandwich Islands (GS)",
            "value": "gs"
          },
          {
            "selected": false,
            "text": "South Sudan (SS)",
            "value": "ss"
          },
          {
            "selected": false,
            "text": "Spain (ES)",
            "value": "es"
          },
          {
            "selected": false,
            "text": "Sri Lanka (LK)",
            "value": "lk"
          },
          {
            "selected": false,
            "text": "Sudan (SD)",
            "value": "sd"
          },
          {
            "selected": false,
            "text": "Suriname (SR)",
            "value": "sr"
          },
          {
            "selected": false,
            "text": "Svalbard and Jan Mayen (SJ)",
            "value": "sj"
          },
          {
            "selected": false,
            "text": "Sweden (SE)",
            "value": "se"
          },
          {
            "selected": false,
            "text": "Switzerland (CH)",
            "value": "ch"
          },
          {
            "selected": false,
            "text": "Syrian Arab Republic (SY)",
            "value": "sy"
          },
          {
            "selected": false,
            "text": "Taiwan, Province of China (TW)",
            "value": "tw"
          },
          {
            "selected": false,
            "text": "Tajikistan (TJ)",
            "value": "tj"
          },
          {
            "selected": false,
            "text": "Tanzania, United Republic of (TZ)",
            "value": "tz"
          },
          {
            "selected": false,
            "text": "Thailand (TH)",
            "value": "th"
          },
          {
            "selected": false,
            "text": "Timor-Leste (TL)",
            "value": "tl"
          },
          {
            "selected": false,
            "text": "Togo (TG)",
            "value": "tg"
          },
          {
            "selected": false,
            "text": "Tokelau (TK)",
            "value": "tk"
          },
          {
            "selected": false,
            "text": "Tonga (TO)",
            "value": "to"
          },
          {
            "selected": false,
            "text": "Trinidad and Tobago (TT)",
            "value": "tt"
          },
          {
            "selected": false,
            "text": "Tunisia (TN)",
            "value": "tn"
          },
          {
            "selected": false,
            "text": "Turkmenistan (TM)",
            "value": "tm"
          },
          {
            "selected": false,
            "text": "Turks and Caicos Islands (TC)",
            "value": "tc"
          },
          {
            "selected": false,
            "text": "Tuvalu (TV)",
            "value": "tv"
          },
          {
            "selected": false,
            "text": "T\u00fcrkiye (TR)",
            "value": "tr"
          },
          {
            "selected": false,
            "text": "Uganda (UG)",
            "value": "ug"
          },
          {
            "selected": false,
            "text": "Ukraine (UA)",
            "value": "ua"
          },
          {
            "selected": false,
            "text": "United Arab Emirates (AE)",
            "value": "ae"
          },
          {
            "selected": false,
            "text": "United Kingdom of Great Britain and Northern Ireland (GB)",
            "value": "gb"
          },
          {
            "selected": false,
            "text": "United States Minor Outlying Islands (UM)",
            "value": "um"
          },
          {
            "selected": false,
            "text": "United States of America (US)",
            "value": "us"
          },
          {
            "selected": false,
            "text": "Uruguay (UY)",
            "value": "uy"
          },
          {
            "selected": false,
            "text": "Uzbekistan (UZ)",
            "value": "uz"
          },
          {
            "selected": false,
            "text": "Vanuatu (VU)",
            "value": "vu"
          },
          {
            "selected": false,
            "text": "Venezuela, Bolivarian Republic of (VE)",
            "value": "ve"
          },
          {
            "selected": false,
            "text": "Viet Nam (VN)",
            "value": "vn"
          },
          {
            "selected": false,
            "text": "Virgin Islands (British) (VG)",
            "value": "vg"
          },
          {
            "selected": false,
            "text": "Virgin Islands (U.S.) (VI)",
            "value": "vi"
          },
          {
            "selected": false,
            "text": "Wallis and Futuna (WF)",
            "value": "wf"
          },
          {
            "selected": false,
            "text": "Western Sahara (EH)",
            "value": "eh"
          },
          {
            "selected": false,
            "text": "Yemen (YE)",
            "value": "ye"
          },
          {
            "selected": false,
            "text": "Zambia (ZM)",
            "value": "zm"
          },
          {
            "selected": false,
            "text": "Zimbabwe (ZW)",
            "value": "zw"
          },
          {
            "selected": false,
            "text": "\u00c5land Islands (AX)",
            "value": "ax"
          }
        ],
        "query": "af,al,dz,as,ad,ao,ai,aq,ag,ar,am,aw,au,at,az,bs,bh,bd,bb,by,be,bz,bj,bm,bt,bo,bq,ba,bw,bv,br,io,bn,bg,bf,bi,cv,kh,cm,ca,ky,cf,td,cl,cn,cx,cc,co,km,cg,cd,ck,cr,hr,cu,cw,cy,cz,ci,dk,dj,dm,do,ec,eg,sv,gq,er,ee,sz,et,fk,fo,fj,fi,fr,gf,pf,tf,ga,gm,ge,de,gh,gi,gr,gl,gd,gp,gu,gt,gg,gn,gw,gy,ht,hm,va,hn,hk,hu,is,in,id,ir,iq,ie,im,il,it,jm,jp,je,jo,kz,ke,ki,kp,kr,kw,kg,la,lv,lb,ls,lr,ly,li,lt,lu,mo,mg,mw,my,mv,ml,mt,mh,mq,mr,mu,yt,mx,fm,md,mc,mn,me,ms,ma,mz,mm,na,nr,np,nl,nc,nz,ni,ne,ng,nu,nf,mk,mp,no,om,pk,pw,ps,pa,pg,py,pe,ph,pn,pl,pt,pr,qa,ro,ru,rw,re,bl,sh,kn,lc,mf,pm,vc,ws,sm,st,sa,sn,rs,sc,sl,sg,sx,sk,si,sb,so,za,gs,ss,es,lk,sd,sr,sj,se,ch,sy,tw,tj,tz,th,tl,tg,tk,to,tt,tn,tm,tc,tv,tr,ug,ua,ae,gb,um,us,uy,uz,vu,ve,vn,vg,vi,wf,eh,ye,zm,zw,ax",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {
          "selected": false,
          "text": ".*",
          "value": ".*"
        },
        "description": "Filter by JA4 TLS fingerprint (regex). Use .* for all.",
        "hide": 0,
        "label": "JA4",
        "name": "ja4",
        "query": ".*",
        "skipUrlSync": false,
        "type": "textbox"
      },
      {
        "current": {
          "selected": false,
          "text": ".*",
          "value": ".*"
        },
        "description": "Filter by client ASN number (regex, e.g. 13335 for Cloudflare). Use .* for all.",
        "hide": 0,
        "label": "ASN",
        "name": "asn",
        "query": ".*",
        "skipUrlSync": false,
        "type": "textbox"
      },
      {
        "current": {
          "selected": false,
          "text": ".*",
          "value": ".*"
        },
        "description": "Filter by edge colo code (regex, e.g. SIN|NRT|LAX). Use .* for all.",
        "hide": 0,
        "label": "Colo",
        "name": "colo",
        "query": ".*",
        "skipUrlSync": false,
        "type": "textbox"
      }
    ]
  },
  "time": {
    "from": "now-6h",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Cloudflare Logpush",
  "uid": "cloudflare-logpush",
  "version": 1,
  "weekStart": ""
}
